import{b as g,u as $e,e as Be,g as Oe,H as ze,f as Me,h as O,N as de,R as Ne}from"./react-vendor-DZ7cWdbH.js";import{L as Ce,T as v,S as w,R as ke,M as qe,a as _e,b as Ue,U as X,c as Ge,d as We,B as W,e as Ve,f as He,A as U,D as F,g as Je,h as Ke,i as ve,C as se,j as ue,k as G,l as Ye,m as Re,n as Te,o as C,F as Z,p as Xe,P as Ze,q as Qe,s as he,r as z,t as M,u as Q,v as et,w as pe,x as tt,y as rt,z as nt,E as st,G as ot}from"./antd-vendor-CO9h1JBs.js";import{p as at,a as it,b as Ee,c as Ie}from"./parquet-vendor-Dl19bzIY.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();var V={exports:{}},D={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ge;function lt(){if(ge)return D;ge=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function n(s,a,o){var i=null;if(o!==void 0&&(i=""+o),a.key!==void 0&&(i=""+a.key),"key"in a){o={};for(var l in a)l!=="key"&&(o[l]=a[l])}else o=a;return a=o.ref,{$$typeof:e,type:s,key:i,ref:a!==void 0?a:null,props:o}}return D.Fragment=r,D.jsx=n,D.jsxs=n,D}var me;function ct(){return me||(me=1,V.exports=lt()),V.exports}var t=ct();const Fe=g.createContext(void 0),H="parquet-viewer-theme";function dt({children:e}){const[r,n]=g.useState(()=>{const o=localStorage.getItem(H);return o==="light"||o==="dark"?o:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}),s=o=>{n(o),localStorage.setItem(H,o)};g.useEffect(()=>{const o=window.matchMedia("(prefers-color-scheme: dark)"),i=l=>{localStorage.getItem(H)||n(l.matches?"dark":"light")};return o.addEventListener("change",i),()=>o.removeEventListener("change",i)},[]),g.useEffect(()=>{r==="dark"?document.body.classList.add("dark"):document.body.classList.remove("dark")},[r]);const a={mode:r,setMode:s};return t.jsx(Fe.Provider,{value:a,children:e})}function oe(){const e=g.useContext(Fe);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e}const{Header:ut,Content:ht}=Ce,{Title:pt}=v;function gt({children:e}){const r=$e(),n=Be(),{mode:s}=oe(),a=n.pathname.replace("#","").split("/")[1]||"viewer",o=[{key:"viewer",icon:t.jsx(_e,{}),label:"Parquet Viewer",onClick:()=>r("/viewer")},{key:"settings",icon:t.jsx(Ue,{}),label:"Settings",onClick:()=>r("/settings")}];return t.jsxs(Ce,{style:{minHeight:"100vh"},children:[t.jsxs(ut,{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 24px",background:s==="dark"?"#141414":"#fff",borderBottom:`1px solid ${s==="dark"?"#303030":"#f0f0f0"}`},children:[t.jsxs(w,{children:[t.jsx(ke,{style:{fontSize:"24px",color:"#1890ff"}}),t.jsx(pt,{level:4,style:{margin:0,color:s==="dark"?"#fff":"#000"},children:"Parquet Viewer"})]}),t.jsx(qe,{mode:"horizontal",selectedKeys:[a],items:o,style:{flex:1,minWidth:0,justifyContent:"flex-end",border:"none",background:"transparent"}})]}),t.jsx(ht,{style:{padding:"4px",minHeight:"calc(100vh - 64px)",background:s==="dark"?"#000":"#f0f2f5"},children:t.jsx("div",{style:{maxWidth:"1600px",margin:"0 auto",background:s==="dark"?"#141414":"#fff",padding:"4px",borderRadius:"8px",minHeight:"calc(100vh - 112px)"},children:e})})]})}const j=[];for(let e=0;e<256;++e)j.push((e+256).toString(16).slice(1));function mt(e,r=0){return(j[e[r+0]]+j[e[r+1]]+j[e[r+2]]+j[e[r+3]]+"-"+j[e[r+4]]+j[e[r+5]]+"-"+j[e[r+6]]+j[e[r+7]]+"-"+j[e[r+8]]+j[e[r+9]]+"-"+j[e[r+10]]+j[e[r+11]]+j[e[r+12]]+j[e[r+13]]+j[e[r+14]]+j[e[r+15]]).toLowerCase()}let J;const ft=new Uint8Array(16);function xt(){if(!J){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");J=crypto.getRandomValues.bind(crypto)}return J(ft)}const yt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),fe={randomUUID:yt};function jt(e,r,n){var a;if(fe.randomUUID&&!e)return fe.randomUUID();e=e||{};const s=e.random??((a=e.rng)==null?void 0:a.call(e))??xt();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,mt(s)}async function ae(e){const r=await fetch(`/test-fixtures/${e}`);if(!r.ok)throw new Error(`Failed to fetch test fixture: ${e}`);return await r.arrayBuffer()}function ie(e){return["small_test.parquet","multi_type_test.parquet","invalid_file.parquet"].includes(e)}const Pe=1e4,wt=3;function bt(e,r=Pe){const n=[];let s=0,a=0;for(let o=0;o<e.length;o++){const i=e[o]??0;if(i<=r)n.push({chunkId:a++,rowGroupIndex:o,rowGroupSize:i,rowGroupStartRow:0,rowGroupEndRow:i,globalStartRow:s,globalEndRow:s+i}),s+=i;else{let l=0;for(;l<i;){const c=Math.min(r,i-l);n.push({chunkId:a++,rowGroupIndex:o,rowGroupSize:i,rowGroupStartRow:l,rowGroupEndRow:l+c,globalStartRow:s,globalEndRow:s+c}),s+=c,l+=c}}}return{totalChunks:n.length,chunkSize:r,chunks:n}}function Le(e,r,n){const s=(e-1)*r,a=s+r,o=[];for(const i of n.chunks)i.globalEndRow>s&&i.globalStartRow<a&&o.push(i.chunkId);return o}function Ae(e,r){return r.chunks.find(n=>n.chunkId===e)}function St(e,r,n,s){const a=(e-1)*r,o=a+r,l=Le(e,r,s).map(u=>{const d=Ae(u,s),h=n[u];return d&&h?{metadata:d,chunk:h}:null}).filter(u=>u!==null).sort((u,d)=>u.metadata.globalStartRow-d.metadata.globalStartRow),c=[];for(const{metadata:u,chunk:d}of l){const h=u.globalStartRow,p=Math.max(0,a-h),f=Math.min(d.rows.length,o-h);for(let x=p;x<f;x++){const m=d.rows[x];if(m){const y=h+x;c.push({...m,__rowIndex:y})}}}return c}function Ct(e,r,n=wt){const s=new Set(r),a=Object.entries(e).map(([d,h])=>({id:Number(d),chunk:h})).filter(d=>d.chunk!==void 0);if(a.length<=n)return e;const o=a.filter(d=>s.has(d.id)),i=a.filter(d=>!s.has(d.id));i.sort((d,h)=>d.chunk.lastAccessTime-h.chunk.lastAccessTime);const l=n-o.length,c=i.slice(-l),u={};for(const d of[...o,...c])u[d.id]=d.chunk;return u}function L(e){return{byteLength:e.size,slice(r,n){return e.slice(r,n).arrayBuffer()}}}async function kt(e){const r=le(e);if(!r.valid)throw new Error(r.error||"Invalid Parquet file");try{let n;if(ie(e.name))try{const u=await ae(e.name);n={byteLength:u.byteLength,slice(d,h){return u.slice(d,h)}}}catch{n=L(e)}else n=L(e);const s=await at(n),a=it(s),o=a.children?Et(a.children):[],i=s.row_groups.map(u=>Number(u.num_rows)),l=i.reduce((u,d)=>u+d,0),c=bt(i);return{id:jt(),name:e.name,size:e.size,loadedAt:new Date,metadata:It(s),rawMetadata:s,columns:o,rowCount:l,rowGroupCount:s.row_groups.length,rowsPerGroup:i,chunkIndex:c,fileHandle:e}}catch(n){throw{message:`Failed to parse Parquet file: ${n instanceof Error?n.message:"Unknown error"}`,...n instanceof Error&&{originalError:n},fileName:e.name}}}async function vt(e,r,n,s){if(r<0||r>=s.length)throw new Error(`Invalid row group index: ${r}`);if(s[r]===void 0||s[r]<0)throw new Error(`Invalid row count for group ${r}`);try{let a;if(ie(e.name))try{const c=await ae(e.name);a={byteLength:c.byteLength,slice(u,d){return c.slice(u,d)}}}catch{a=L(e)}else a=L(e);let o=0;for(let c=0;c<r;c++)o+=s[c]??0;const i=o+(s[r]??0);let l=[];return await Ee({file:a,metadata:n,rowStart:o,rowEnd:i,compressors:Ie,rowFormat:"object",onComplete:c=>{l=c}}),l}catch(a){throw{message:`Failed to load row group ${r}: ${a instanceof Error?a.message:"Unknown error"}`,...a instanceof Error&&{originalError:a},fileName:e.name}}}async function Rt(e,r,n){try{let s;if(ie(e.name))try{const l=await ae(e.name);s={byteLength:l.byteLength,slice(c,u){return l.slice(c,u)}}}catch{s=L(e)}else s=L(e);const a=r.globalStartRow,o=r.globalEndRow;let i=[];return await Ee({file:s,metadata:n,rowStart:a,rowEnd:o,compressors:Ie,rowFormat:"object",onComplete:l=>{i=l}}),{chunkId:r.chunkId,rowGroupIndex:r.rowGroupIndex,startRow:r.globalStartRow,endRow:r.globalEndRow,rows:i,lastAccessTime:Date.now()}}catch(s){throw{message:`Failed to load chunk ${r.chunkId}: ${s instanceof Error?s.message:"Unknown error"}`,...s instanceof Error&&{originalError:s},fileName:e.name}}}async function Tt(e,r,n,s){if((s[r.rowGroupIndex]??0)<=Pe){const o=await vt(e,r.rowGroupIndex,n,s);return{chunkId:r.chunkId,rowGroupIndex:r.rowGroupIndex,startRow:r.globalStartRow,endRow:r.globalEndRow,rows:o,lastAccessTime:Date.now()}}else return Rt(e,r,n)}function Et(e){const r=[],n=(s,a=[])=>{const o=s.element,i=[...a,o.name],l=i.join(".");if(o.type){const c=o.logical_type?o.logical_type.type:o.converted_type;r.push({name:l,type:o.type,nullable:o.repetition_type==="OPTIONAL",...c&&{logicalType:c}})}s.children&&s.children.length>0&&s.children.forEach(c=>n(c,i))};return e.forEach(s=>n(s)),r}function It(e){const r=Ft(e.key_value_metadata);return{numRowGroups:e.row_groups.length,version:String(e.version),...e.created_by&&{createdBy:e.created_by},...r&&{keyValueMetadata:r}}}function Ft(e){if(!e||e.length===0)return;const r={};for(const n of e)n.key&&n.value&&(r[n.key]=n.value);return Object.keys(r).length>0?r:void 0}function le(e){return e.name.toLowerCase().endsWith(".parquet")?e.size<100?{valid:!1,error:"File is too small to be a valid Parquet file"}:{valid:!0}:{valid:!1,error:"File must have .parquet extension"}}function Pt(){const[e,r]=g.useState(null),[n,s]=g.useState(!1),[a,o]=g.useState(null),i=g.useCallback(async c=>{o(null);const u=le(c);if(!u.valid){o({message:u.error??"Invalid Parquet file",fileName:c.name});return}s(!0);try{const d=await kt(c);r(d),o(null)}catch(d){Lt(d)?o(d):o({message:`Failed to load file: ${d instanceof Error?d.message:"Unknown error"}`,fileName:c.name}),r(null)}finally{s(!1)}},[]),l=g.useCallback(()=>{r(null),o(null),s(!1)},[]);return{file:e,loading:n,error:a,loadFile:i,clearFile:l}}function Lt(e){return typeof e=="object"&&e!==null&&"message"in e&&typeof e.message=="string"}function At(e,r=1e4){const n=[];return e.rowsPerGroup.forEach((s,a)=>{if(s>r){const o=s/e.rowCount*e.size;n.push({index:a,rows:s,sizeBytes:o})}}),n}const Dt={hideLargeFileWarning:!1};function xe(){return{...Dt}}const ye="parquet-viewer-preferences";class $t{load(){try{const r=localStorage.getItem(ye);if(r){const n=JSON.parse(r);return{...xe(),...n}}}catch(r){console.error("Failed to load preferences from localStorage:",r)}return xe()}save(r){try{localStorage.setItem(ye,JSON.stringify(r))}catch(n){console.error("Failed to save preferences to localStorage:",n)}}update(r,n){const s=this.load();s[r]=n,this.save(s)}}const ce=new $t;function ee(){return ce.load()}function Bt(e){ce.save(e)}function Ot(e,r){ce.update(e,r)}function zt(e){const[r,n]=g.useState(!1),[s,a]=g.useState([]);return g.useEffect(()=>{if(!e){n(!1),a([]);return}if(ee().hideLargeFileWarning){n(!1),a([]);return}const c=At(e);c.length>0?(a(c),n(!0)):(n(!1),a([]))},[e]),{showWarning:r,largeGroups:s,handleDismiss:()=>{n(!1)},handleDontShowAgain:()=>{Ot("hideLargeFileWarning",!0),n(!1)}}}const{Dragger:Mt}=X,{Text:je,Paragraph:Nt}=v;function qt({mode:e,loading:r,onFileSelect:n,loadedButtonText:s}){const a=async i=>{const{file:l}=i,c=l.originFileObj||(l instanceof File?l:null);c&&await n(c)},o=i=>le(i).valid?!1:X.LIST_IGNORE;return r?t.jsxs("div",{style:{textAlign:"center"},role:"status","aria-live":"polite","aria-label":"Loading file",children:[t.jsx(Ge,{size:"large"}),t.jsx(Nt,{style:{marginTop:"16px",color:"#999"},children:"Loading Parquet file metadata..."})]}):e==="initial"?t.jsx("div",{style:{padding:"24px"},children:t.jsxs(Mt,{name:"file",multiple:!1,accept:".parquet",beforeUpload:o,onChange:a,showUploadList:!1,"data-testid":"file-upload-dragger","aria-label":"Upload Parquet file by clicking or dragging",children:[t.jsx("p",{className:"ant-upload-drag-icon",children:t.jsx(We,{style:{fontSize:"64px",color:"#1890ff"}})}),t.jsx("p",{className:"ant-upload-text",style:{fontSize:"18px"},children:"Click or drag Parquet file to this area"}),t.jsx("p",{className:"ant-upload-hint",style:{fontSize:"14px",color:"#999"},children:"Select a .parquet file to view its contents. The file will be processed locally in your browser - no data is uploaded to any server."}),t.jsxs("div",{style:{marginTop:"4px"},children:[t.jsx(je,{type:"secondary",children:"Supported: Apache Parquet (.parquet)"}),t.jsx("br",{}),t.jsx(je,{type:"secondary",children:"Max recommended size: 500MB"})]})]})}):t.jsx("div",{style:{marginBottom:"16px",textAlign:"right"},children:t.jsx(X,{name:"file",multiple:!1,accept:".parquet",beforeUpload:o,onChange:a,showUploadList:!1,children:t.jsx(W,{icon:t.jsx(Ve,{}),"aria-label":"Load a different Parquet file",children:s||"Load Different File"})})})}const{Text:N,Paragraph:we}=v;function _t({visible:e,error:r,onClose:n}){return r?t.jsxs(He,{title:t.jsxs("span",{children:[t.jsx(Je,{style:{color:"#ff4d4f",marginRight:"8px"},"aria-hidden":"true"}),"Failed to Load Parquet File"]}),open:e,onCancel:n,onOk:n,cancelButtonProps:{style:{display:"none"}},okText:"Close","aria-labelledby":"error-modal-title","aria-describedby":"error-modal-description",children:[t.jsx(U,{message:"Error Loading File",description:r.message,type:"error",showIcon:!0,style:{marginBottom:"16px"}}),r.fileName&&t.jsxs(t.Fragment,{children:[t.jsx(F,{}),t.jsxs("div",{children:[t.jsx(N,{strong:!0,children:"File Name:"}),t.jsx("br",{}),t.jsx(N,{code:!0,children:r.fileName})]})]}),r.originalError&&t.jsxs(t.Fragment,{children:[t.jsx(F,{}),t.jsxs("div",{children:[t.jsx(N,{strong:!0,children:"Technical Details:"}),t.jsx(we,{style:{marginTop:"8px"},children:t.jsx(N,{type:"secondary",style:{fontSize:"12px",fontFamily:"monospace"},children:r.originalError.message})})]})]}),t.jsx(F,{}),t.jsx(we,{type:"secondary",style:{fontSize:"12px",marginBottom:0},children:"Please ensure the file is a valid Parquet file and try again."})]}):null}function Ut(e){if(e==null)return"null";if(e instanceof Date)return e.toISOString();if(typeof e=="boolean")return e?"true":"false";if(typeof e=="number")return Number.isInteger(e)?e.toLocaleString():e.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:6});if(typeof e=="bigint")return e.toString();if(typeof e=="object")try{return JSON.stringify(e)}catch{return"[Object]"}return String(e)}function Gt(e){return typeof e=="number"||typeof e=="bigint"}function Wt(e){return typeof e=="boolean"}function Vt(e){return e==null}function Ht(e,r=100){return e.length<=r?e:e.slice(0,r)+"..."}function Jt(e,r=100){return e.length>r}function te(e){if(e===0)return"0 B";const r=["B","KB","MB","GB","TB"],n=1024,s=Math.floor(Math.log(e)/Math.log(n));return`${(e/Math.pow(n,s)).toFixed(2)} ${r[s]}`}function Kt(e,r){if(r)switch(r){case"UTF8":case"STRING":return"String";case"TIMESTAMP_MILLIS":case"TIMESTAMP_MICROS":return"Timestamp";case"DATE":return"Date";case"DECIMAL":return"Decimal";case"JSON":return"JSON";case"BSON":return"BSON";case"UUID":return"UUID";default:return r}switch(e){case"BOOLEAN":return"Boolean";case"INT32":return"Int32";case"INT64":return"Int64";case"FLOAT":return"Float";case"DOUBLE":return"Double";case"BYTE_ARRAY":return"ByteArray";case"FIXED_LEN_BYTE_ARRAY":return"FixedByteArray";default:return e}}const{Text:b,Paragraph:Yt}=v;function Xt({visible:e,file:r,largeGroups:n,onDismiss:s,onDontShowAgain:a}){return!e||!r||n.length===0?null:t.jsx(U,{message:"Large Row Groups Detected",description:t.jsxs(w,{vertical:!0,style:{width:"100%"},size:"small",children:[t.jsxs(b,{children:["This file contains ",n.length," large row group",n.length>1?"s":""," that will be automatically split into 10,000-row chunks and loaded on-demand for efficient memory usage."]}),t.jsx(W,{type:"link",size:"small",icon:t.jsx(ve,{}),onClick:a,style:{paddingLeft:0},children:"Don't show again"}),t.jsx(se,{ghost:!0,size:"small",items:[{key:"details",label:"View Details",children:t.jsxs(w,{vertical:!0,style:{width:"100%"},size:"middle",children:[t.jsxs("div",{children:[t.jsx(b,{strong:!0,children:"File:"})," ",t.jsx(b,{code:!0,children:r.name}),t.jsx("br",{}),t.jsx(b,{strong:!0,children:"Total Size:"})," ",t.jsx(b,{children:te(r.size)}),t.jsx("br",{}),t.jsx(b,{strong:!0,children:"Total Rows:"})," ",t.jsx(b,{children:r.rowCount.toLocaleString()}),t.jsx("br",{}),t.jsx(b,{strong:!0,children:"Row Groups:"})," ",t.jsx(b,{children:r.rowGroupCount})]}),t.jsxs("div",{children:[t.jsxs(b,{strong:!0,children:["Large Row Groups (",n.length,"):"]}),t.jsx(ue,{size:"small",bordered:!0,dataSource:n,style:{marginTop:"4px"},renderItem:o=>t.jsx(ue.Item,{children:t.jsxs(w,{style:{width:"100%",justifyContent:"space-between"},children:[t.jsxs("span",{children:[t.jsxs(b,{strong:!0,children:["Group ",o.index]}),t.jsxs(b,{type:"secondary",children:[" (",o.rows.toLocaleString()," rows)"]})]}),t.jsxs(b,{type:"warning",strong:!0,children:["~",te(o.sizeBytes)]})]})})})]}),t.jsx("div",{children:t.jsxs(Yt,{type:"secondary",style:{fontSize:"12px",marginBottom:0},children:[t.jsx("strong",{children:"How streaming works:"}),t.jsxs("ul",{style:{marginTop:"4px",paddingLeft:"20px"},children:[t.jsx("li",{children:"Row groups larger than 10,000 rows are split into chunks"}),t.jsx("li",{children:"Only the chunks needed for the current page are loaded"}),t.jsx("li",{children:"Memory usage is bounded regardless of file size"}),t.jsx("li",{children:"Older chunks are automatically evicted to maintain a 30,000-row cache"})]})]})})]})}]})]}),type:"info",showIcon:!0,icon:t.jsx(Ke,{}),closable:!0,onClose:s,style:{marginBottom:"16px"}})}var K,be;function Zt(){return be||(be=1,K=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var r=document.activeElement,n=[],s=0;s<e.rangeCount;s++)n.push(e.getRangeAt(s));switch(r.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":r.blur();break;default:r=null;break}return e.removeAllRanges(),function(){e.type==="Caret"&&e.removeAllRanges(),e.rangeCount||n.forEach(function(a){e.addRange(a)}),r&&r.focus()}}),K}var Y,Se;function Qt(){if(Se)return Y;Se=1;var e=Zt(),r={"text/plain":"Text","text/html":"Url",default:"Text"},n="Copy to clipboard: #{key}, Enter";function s(o){var i=(/mac os x/i.test(navigator.userAgent)?"âŒ˜":"Ctrl")+"+C";return o.replace(/#{\s*key\s*}/g,i)}function a(o,i){var l,c,u,d,h,p,f=!1;i||(i={}),l=i.debug||!1;try{u=e(),d=document.createRange(),h=document.getSelection(),p=document.createElement("span"),p.textContent=o,p.ariaHidden="true",p.style.all="unset",p.style.position="fixed",p.style.top=0,p.style.clip="rect(0, 0, 0, 0)",p.style.whiteSpace="pre",p.style.webkitUserSelect="text",p.style.MozUserSelect="text",p.style.msUserSelect="text",p.style.userSelect="text",p.addEventListener("copy",function(m){if(m.stopPropagation(),i.format)if(m.preventDefault(),typeof m.clipboardData>"u"){l&&console.warn("unable to use e.clipboardData"),l&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var y=r[i.format]||r.default;window.clipboardData.setData(y,o)}else m.clipboardData.clearData(),m.clipboardData.setData(i.format,o);i.onCopy&&(m.preventDefault(),i.onCopy(m.clipboardData))}),document.body.appendChild(p),d.selectNodeContents(p),h.addRange(d);var x=document.execCommand("copy");if(!x)throw new Error("copy command was unsuccessful");f=!0}catch(m){l&&console.error("unable to copy using execCommand: ",m),l&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(i.format||"text",o),i.onCopy&&i.onCopy(window.clipboardData),f=!0}catch(y){l&&console.error("unable to copy using clipboardData: ",y),l&&console.error("falling back to prompt"),c=s("message"in i?i.message:n),window.prompt(c,o)}}finally{h&&(typeof h.removeRange=="function"?h.removeRange(d):h.removeAllRanges()),p&&document.body.removeChild(p),u()}return f}return Y=a,Y}var er=Qt();const De=Oe(er),{Text:S}=v;function tr(e){try{const r=JSON.parse(e);if(r!==null&&typeof r=="object")return r}catch{}return null}const re=(e,r="root",n="",s=0,a=10,o)=>{const i=n?`${n}.${r}`:String(r);if(s>a)return{key:i,title:t.jsxs("span",{children:[t.jsxs(S,{type:"secondary",children:[r,": "]}),t.jsx(S,{type:"warning",children:"[Maximum depth reached]"})]}),isLeaf:!0};if(e==null)return{key:i,title:t.jsxs("span",{children:[t.jsxs(S,{type:"secondary",children:[r,": "]}),t.jsx(S,{type:"secondary",children:String(e)})]}),isLeaf:!0};if(typeof e!="object"){const f=typeof e=="string"?`"${e}"`:String(e);return{key:i,title:t.jsxs("span",{children:[t.jsxs(S,{type:"secondary",children:[r,": "]}),t.jsx(S,{style:{color:typeof e=="number"?o.colorWarning:typeof e=="boolean"?o.colorInfo:o.colorSuccess},children:f})]}),isLeaf:!0}}if(Array.isArray(e)){const x=Math.min(e.length,100),m=e.length>100,y=e.slice(0,x).map((E,I)=>re(E,`[${I}]`,i,s+1,a,o));m&&y.push({key:`${i}.$more`,title:t.jsxs(S,{type:"warning",children:["... ",e.length-100," more items (showing first ",100,")"]}),isLeaf:!0});const A={key:i,title:t.jsxs("span",{children:[t.jsxs(S,{type:"secondary",children:[r,": "]}),t.jsxs(S,{strong:!0,children:["Array(",e.length,")"]})]}),isLeaf:y.length===0};return y.length>0&&(A.children=y),A}const l=Object.entries(e),c=100,u=Math.min(l.length,c),d=l.length>c,h=l.slice(0,u).map(([f,x])=>re(x,f,i,s+1,a,o));d&&h.push({key:`${i}.$more`,title:t.jsxs(S,{type:"warning",children:["... ",l.length-c," more properties (showing first ",c,")"]}),isLeaf:!0});const p={key:i,title:t.jsxs("span",{children:[t.jsxs(S,{type:"secondary",children:[r,": "]}),t.jsxs(S,{strong:!0,children:["Object(",l.length,")"]})]}),isLeaf:h.length===0};return h.length>0&&(p.children=h),p};function rr({metadata:e}){const{token:r}=G.useToken(),n=g.useMemo(()=>{if(!e||Object.keys(e).length===0)return[];const s={};for(const[a,o]of Object.entries(e)){const i=tr(o);i!==null?s[a]=i:s[a]=o}return Object.entries(s).map(([a,o])=>re(o,a,"",0,10,r))},[e,r]);return!e||Object.keys(e).length===0?t.jsx("span",{style:{color:"#8c8c8c",fontStyle:"italic"},children:"No custom metadata"}):t.jsx("div",{style:{padding:"8px",borderRadius:"4px",backgroundColor:r.colorBgContainer,border:`1px solid ${r.colorBorder}`,maxHeight:"400px",overflow:"auto"},children:t.jsx(Ye,{showLine:!0,defaultExpandAll:!0,treeData:n,blockNode:!0,style:{backgroundColor:"transparent"}})})}const{Text:q}=v,{useApp:nr}=Re;function sr({file:e,defaultExpanded:r=!0}){const[n,s]=g.useState(r?["1","2","3"]:[]),{message:a}=nr(),o=()=>{const l={fileName:e.name,fileSize:e.size,rowCount:e.rowCount,rowGroupCount:e.rowGroupCount,rowsPerGroup:e.rowsPerGroup,columns:e.columns,metadata:e.metadata,loadedAt:e.loadedAt.toISOString()};De(JSON.stringify(l,null,2))?a.success("Metadata copied to clipboard"):a.error("Failed to copy metadata")},i=[{title:"Column Name",dataIndex:"name",key:"name",render:l=>t.jsx(q,{code:!0,children:l})},{title:"Type",dataIndex:"type",key:"type",render:(l,c)=>t.jsx(q,{style:{color:"#1890ff"},children:Kt(l,c.logicalType)})},{title:"Nullable",dataIndex:"nullable",key:"nullable",render:l=>l?"Yes":"No"}];return t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsxs(w,{style:{marginBottom:"8px",width:"100%",justifyContent:"space-between"},children:[t.jsxs(w,{children:[t.jsx(ke,{}),t.jsx(q,{strong:!0,children:"File Information"})]}),t.jsx(W,{size:"small",icon:t.jsx(Te,{}),onClick:o,children:"Copy Metadata as JSON"})]}),t.jsx(se,{activeKey:n,onChange:l=>s(l),accordion:!1,items:[{key:"1",label:"Basic Information",children:t.jsxs(C,{column:1,size:"small",bordered:!0,children:[t.jsx(C.Item,{label:"File Name",children:e.name}),t.jsx(C.Item,{label:"File Size",children:te(e.size)}),t.jsx(C.Item,{label:"Total Rows",children:e.rowCount.toLocaleString()}),t.jsx(C.Item,{label:"Row Groups",children:e.rowGroupCount}),t.jsx(C.Item,{label:"Loaded At",children:e.loadedAt.toLocaleString()})]})},{key:"2",label:`Schema (${e.columns.length} columns)`,children:t.jsx(Z,{dataSource:e.columns,columns:i,rowKey:"name",size:"small",pagination:!1,scroll:{y:300}})},{key:"3",label:"File Metadata",children:t.jsxs(t.Fragment,{children:[t.jsxs(C,{column:1,size:"small",bordered:!0,children:[t.jsx(C.Item,{label:"Parquet Version",children:e.metadata.version}),t.jsx(C.Item,{label:"Created By",children:e.metadata.createdBy||"Unknown"}),t.jsx(C.Item,{label:"Row Groups",children:e.metadata.numRowGroups}),e.metadata.keyValueMetadata&&t.jsx(C.Item,{label:"Custom Metadata",children:t.jsx(rr,{metadata:e.metadata.keyValueMetadata})})]}),t.jsxs("div",{style:{marginTop:"16px"},children:[t.jsx(q,{strong:!0,style:{display:"block",marginBottom:"8px"},children:"Row Group Distribution:"}),t.jsx(Z,{dataSource:e.rowsPerGroup.map((l,c)=>({index:c,rows:l,percentage:(l/e.rowCount*100).toFixed(1)})),columns:[{title:"Group",dataIndex:"index",key:"index"},{title:"Rows",dataIndex:"rows",key:"rows",render:l=>l.toLocaleString()},{title:"Percentage",dataIndex:"percentage",key:"percentage",render:l=>`${l}%`}],size:"small",pagination:!1,scroll:{y:200},rowKey:"index"})]})]})}]})]})}function or(e){const[r,n]=g.useState({}),[s,a]=g.useState(!1),[o,i]=g.useState(1),[l,c]=g.useState(500);g.useEffect(()=>{n({}),i(1)},[e==null?void 0:e.id]);const u=g.useCallback(async(f,x)=>{if(!e)return;const m=x??l;a(!0);try{const y=Le(f,m,e.chunkIndex),A=y.filter(E=>!r[E]);if(A.length>0){const E=A.map(async R=>{const k=Ae(R,e.chunkIndex);if(!k)throw new Error(`Chunk metadata not found for chunk ${R}`);const P=await Tt(e.fileHandle,k,e.rawMetadata,e.rowsPerGroup);return{chunkId:R,chunk:P}}),I=await Promise.all(E);n(R=>{const k={...R};for(const{chunkId:P,chunk:B}of I)k[P]=B;for(const P of y){const B=k[P];B&&(k[P]={...B,lastAccessTime:Date.now()})}return Ct(k,y)})}else n(E=>{const I={...E};for(const R of y){const k=I[R];k&&(I[R]={...k,lastAccessTime:Date.now()})}return I});i(f),x!==void 0&&c(x)}catch(y){throw console.error("Failed to load chunks:",y),y}finally{a(!1)}},[e,l,r]),d=g.useMemo(()=>e?St(o,l,r,e.chunkIndex):[],[e,o,l,r]),h=g.useCallback(()=>{n({})},[]),p=g.useMemo(()=>{const f=Object.values(r).filter(x=>x!==void 0);return{chunkCount:f.length,totalRows:f.reduce((x,m)=>x+((m==null?void 0:m.rows.length)??0),0)}},[r]);return{currentPageRows:d,loading:s,currentPage:o,pageSize:l,changePage:u,clearCache:h,cacheStats:p}}function ar({value:e,maxLength:r=100}){if(Vt(e))return t.jsx("span",{style:{color:"#999",fontStyle:"italic"},children:"null"});if(Wt(e))return t.jsx(Xe,{color:e?"green":"default",children:String(e)});const n=Ut(e);return Gt(e)?t.jsx("div",{style:{textAlign:"right",fontFamily:"monospace"},children:n}):Jt(n,r)?t.jsx(ir,{value:n,maxLength:r}):t.jsx("span",{children:n})}function ir({value:e,maxLength:r}){const n=()=>{De(e)?he.success("Copied to clipboard"):he.error("Failed to copy")},s=t.jsxs("div",{style:{maxWidth:"400px",maxHeight:"300px",overflow:"auto"},children:[t.jsx("pre",{style:{margin:0,marginBottom:"8px",fontSize:"12px",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:e}),t.jsx(W,{size:"small",icon:t.jsx(Te,{}),onClick:n,block:!0,children:"Copy to Clipboard"})]});return t.jsx(Ze,{content:s,title:"Full Value",trigger:"click",placement:"topLeft",children:t.jsx(Qe,{title:"Click to view full value",children:t.jsx("span",{style:{cursor:"pointer",color:"#1890ff",textDecoration:"underline",textDecorationStyle:"dotted"},children:Ht(e,r)})})})}function lr(e,r){return{title:r||e,dataIndex:e,key:e,render:n=>t.jsx(ar,{value:n}),sorter:(n,s)=>{const a=n[e],o=s[e];return a==null?-1:o==null?1:typeof a=="number"&&typeof o=="number"?a-o:String(a).localeCompare(String(o))}}}const{Text:T}=v;function cr({file:e,error:r}){const{currentPageRows:n,loading:s,currentPage:a,pageSize:o,changePage:i,clearCache:l}=or(e);g.useEffect(()=>{l(),i(1,500).catch(d=>{console.error("Failed to load first page:",d)})},[e.id]);const c=async(d,h)=>{try{await i(d,h)}catch(p){console.error("Failed to change page:",p)}},u=e.columns.map(d=>lr(d.name,d.name));return r?t.jsx(U,{title:"Error Loading Data",description:r,type:"error",showIcon:!0}):!s&&n.length===0&&a===1?t.jsx(U,{title:"No Data",description:"This Parquet file appears to be empty or the first page could not be loaded.",type:"info",showIcon:!0}):t.jsxs("div",{children:[t.jsxs(w,{style:{marginBottom:"16px"},role:"status","aria-live":"polite",children:[t.jsxs(T,{children:[t.jsx(T,{strong:!0,children:"Showing rows:"})," ",((a-1)*o+1).toLocaleString()," -"," ",Math.min(a*o,e.rowCount).toLocaleString()," of ",e.rowCount.toLocaleString()]}),t.jsx(T,{type:"secondary","aria-hidden":"true",children:"|"}),t.jsxs(T,{children:[t.jsx(T,{strong:!0,children:"Columns:"})," ",e.columns.length]}),t.jsx(T,{type:"secondary","aria-hidden":"true",children:"|"}),t.jsxs(T,{children:[t.jsx(T,{strong:!0,children:"Row Groups:"})," ",e.rowGroupCount]})]}),t.jsx(Z,{columns:u,dataSource:n,rowKey:d=>`row-${d.__rowIndex}`,loading:s,"aria-label":`Parquet data table with ${e.rowCount} rows and ${e.columns.length} columns`,pagination:{current:a,pageSize:o,total:e.rowCount,showSizeChanger:!0,pageSizeOptions:["100","500","1000","2000"],showTotal:(d,h)=>`${h[0]}-${h[1]} of ${d} rows`,onChange:c,onShowSizeChange:c},scroll:{x:e.columns.length*150,y:600},virtual:!0,size:"small",bordered:!0,sticky:!0})]})}const{Title:dr,Paragraph:ur}=v;function hr(){const{file:e,loading:r,error:n,loadFile:s,clearFile:a}=Pt(),{showWarning:o,largeGroups:i,handleDismiss:l,handleDontShowAgain:c}=zt(e),u=async p=>{try{await s(p)}catch(f){console.error("Error loading file:",f)}},d=()=>{a()},h=e?"loaded":"initial";return t.jsxs("main",{role:"main","aria-label":"Parquet File Viewer",children:[t.jsx("header",{children:t.jsxs(w,{orientation:"vertical",size:"small",style:{marginBottom:"24px",width:"100%"},children:[t.jsx(dr,{level:2,style:{margin:0},children:"Parquet File Viewer"}),t.jsx(ur,{type:"secondary",style:{margin:0},children:"Load and explore Parquet files directly in your browser. All processing happens locally - no data is uploaded to any server."})]})}),t.jsx(F,{}),t.jsx(qt,{mode:h,loading:r,onFileSelect:u}),e&&t.jsxs(t.Fragment,{children:[t.jsx(F,{}),t.jsx(Xt,{visible:o,file:e,largeGroups:i,onDismiss:l,onDontShowAgain:c}),t.jsx(sr,{file:e,defaultExpanded:!0}),t.jsx(F,{}),t.jsx(cr,{file:e})]}),t.jsx(_t,{visible:!!n&&!r,error:n,onClose:d})]})}function pr(){const[e,r]=g.useState(ee),n=s=>{r(a=>{const o={...a,...s};return Bt(o),o})};return g.useEffect(()=>{const s=ee();r(s)},[]),{preferences:e,setPreferences:n}}const{Text:ne}=v,_=({name:e,value:r})=>{const n=String(r),s=typeof r=="string"&&(n.startsWith("#")||n.startsWith("rgb")||n.startsWith("hsl"));return t.jsx("div",{style:{marginBottom:12},children:t.jsxs(w,{align:"start",style:{width:"100%"},children:[s&&t.jsx("div",{style:{width:40,height:40,backgroundColor:n,border:"1px solid #d9d9d9",borderRadius:4,flexShrink:0}}),t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsx(ne,{strong:!0,style:{display:"block"},children:e}),t.jsx(ne,{type:"secondary",style:{fontSize:12,fontFamily:"monospace",display:"block",wordBreak:"break-all"},children:n})]})]})})},gr=()=>{const{token:e}=G.useToken(),r={},n={},s={},a={};Object.entries(e).forEach(([i,l])=>{const c=i.toLowerCase();c.includes("color")||c.includes("bg")?r[i]=l:c.includes("size")||c.includes("width")||c.includes("height")||c.includes("margin")||c.includes("padding")||c.includes("radius")?n[i]=l:c.includes("font")||c.includes("line")||c.includes("text")?s[i]=l:a[i]=l});const o=[{key:"colors",label:`Colors & Backgrounds (${Object.keys(r).length})`,children:t.jsx(z,{gutter:[16,16],children:Object.entries(r).map(([i,l])=>t.jsx(M,{xs:24,sm:12,md:8,lg:6,children:t.jsx(_,{name:i,value:l})},i))})},{key:"sizes",label:`Sizes & Spacing (${Object.keys(n).length})`,children:t.jsx(z,{gutter:[16,16],children:Object.entries(n).map(([i,l])=>t.jsx(M,{xs:24,sm:12,md:8,lg:6,children:t.jsx(_,{name:i,value:l})},i))})},{key:"fonts",label:`Typography (${Object.keys(s).length})`,children:t.jsx(z,{gutter:[16,16],children:Object.entries(s).map(([i,l])=>t.jsx(M,{xs:24,sm:12,md:8,lg:6,children:t.jsx(_,{name:i,value:l})},i))})},{key:"other",label:`Other Tokens (${Object.keys(a).length})`,children:t.jsx(z,{gutter:[16,16],children:Object.entries(a).map(([i,l])=>t.jsx(M,{xs:24,sm:12,md:8,lg:6,children:t.jsx(_,{name:i,value:l})},i))})}];return t.jsx(Q,{title:t.jsxs(w,{children:[t.jsx(et,{}),"Theme Tokens"]}),children:t.jsxs(w,{orientation:"vertical",size:"middle",style:{width:"100%"},children:[t.jsx(ne,{type:"secondary",children:"Explore all design tokens from the current Ant Design theme. These values are automatically generated based on your selected theme (light/dark) and can be used throughout the application."}),t.jsx(se,{items:o,defaultActiveKey:[]})]})})},{Title:mr,Paragraph:fr,Text:$}=v;function xr(){const{mode:e,setMode:r}=oe(),{preferences:n,setPreferences:s}=pr(),a=i=>{r(i?"dark":"light")},o=i=>{s({hideLargeFileWarning:!i})};return t.jsxs("div",{style:{padding:"8px",maxWidth:"1200px",margin:"0 auto"},children:[t.jsx(mr,{level:2,children:"Settings"}),t.jsx(fr,{children:"Customize your Parquet Viewer experience. Settings are automatically saved to your browser's local storage."}),t.jsx(Q,{title:t.jsxs(w,{children:[e==="dark"?t.jsx(tt,{}):t.jsx(rt,{}),t.jsx("span",{children:"Appearance"})]}),style:{marginBottom:"8px"},children:t.jsxs(w,{orientation:"vertical",size:"small",style:{width:"100%"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx($,{strong:!0,children:"Dark Mode"}),t.jsx("br",{}),t.jsx($,{type:"secondary",children:"Toggle between light and dark theme"})]}),t.jsx(pe,{checked:e==="dark",onChange:a})]}),t.jsx(F,{}),t.jsx($,{type:"secondary",children:"Your theme preference is saved to browser local storage and will persist across sessions."})]})}),t.jsx(Q,{title:t.jsxs(w,{children:[n.hideLargeFileWarning?t.jsx(ve,{}):t.jsx(nt,{}),t.jsx("span",{children:"Notifications"})]}),style:{marginBottom:"8px"},children:t.jsx(w,{orientation:"vertical",size:"small",style:{width:"100%"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx($,{strong:!0,children:"Show Large File Warning"}),t.jsx("br",{}),t.jsx($,{type:"secondary",children:"Display an informational banner when files contain large row groups (>100MB)"})]}),t.jsx(pe,{checked:!n.hideLargeFileWarning,onChange:o})]})})}),t.jsx(gr,{})]})}function yr(){const{mode:e}=oe();return t.jsx(st,{theme:{algorithm:e==="dark"?G.darkAlgorithm:G.defaultAlgorithm},children:t.jsx(Re,{children:t.jsx(ze,{children:t.jsx(gt,{children:t.jsxs(Me,{children:[t.jsx(O,{path:"/",element:t.jsx(de,{to:"/viewer",replace:!0})}),t.jsx(O,{path:"/viewer",element:t.jsx(hr,{})}),t.jsx(O,{path:"/settings",element:t.jsx(xr,{})}),t.jsx(O,{path:"*",element:t.jsx(de,{to:"/",replace:!0})})]})})})})})}function jr(){return t.jsx(dt,{children:t.jsx(yr,{})})}ot.createRoot(document.getElementById("root")).render(t.jsx(Ne.StrictMode,{children:t.jsx(jr,{})}));
