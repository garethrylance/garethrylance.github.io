import{y as Ye,r as u,ac as He,K as Me,H as P,a6 as ee,z as We,A as Ke,a4 as N,ad as Ze,D as Xe,M as Qe,ae as Je,I as Z,a as X,j as r,S as _,T as k,a1 as Ae,h as H,u as et,B as ge,b as Se,d as Le,a0 as tt}from"./index-DzaOA67_.js";import{m as Pe,u as nt,R as oe,s as W,C as b,a as O,f as E,E as K,T as rt}from"./fileValidation-AnOVqnKf.js";import{u as it,R as st}from"./index-BNVjEioM.js";import{R as he}from"./CheckCircleOutlined-Dy24CADW.js";import{R as $e}from"./FileOutlined-BhB1Rg8V.js";import{u as ot,b as v}from"./index-sNGHL25X.js";import{L as le,R as lt,a as at,b as we}from"./ThunderboltOutlined-CnzgxFF7.js";import{R as be,C as G}from"./row--SaJyCfC.js";import{S as q}from"./index-BQp54Riu.js";import{P as ct,O as dt}from"./ObjectTreeView-p9lgLxP1.js";import{A as ut}from"./index-oKRoomyI.js";import"./tslib.es6-DBPwE56R.js";var ft={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zM464 544H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H212V612h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200z"}}]},name:"appstore",theme:"outlined"},mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"},ht={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M326 664H104c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h174v176c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V696c0-17.7-14.3-32-32-32zm16-576h-48c-8.8 0-16 7.2-16 16v176H104c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h222c17.7 0 32-14.3 32-32V104c0-8.8-7.2-16-16-16zm578 576H698c-17.7 0-32 14.3-32 32v224c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V744h174c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zm0-384H746V104c0-8.8-7.2-16-16-16h-48c-8.8 0-16 7.2-16 16v224c0 17.7 14.3 32 32 32h222c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16z"}}]},name:"compress",theme:"outlined"},pt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 385.6a446.7 446.7 0 00-96-142.4 446.7 446.7 0 00-142.4-96C631.1 123.8 572.5 112 512 112s-119.1 11.8-174.4 35.2a446.7 446.7 0 00-142.4 96 446.7 446.7 0 00-96 142.4C75.8 440.9 64 499.5 64 560c0 132.7 58.3 257.7 159.9 343.1l1.7 1.4c5.8 4.8 13.1 7.5 20.6 7.5h531.7c7.5 0 14.8-2.7 20.6-7.5l1.7-1.4C901.7 817.7 960 692.7 960 560c0-60.5-11.9-119.1-35.2-174.4zM761.4 836H262.6A371.12 371.12 0 01140 560c0-99.4 38.7-192.8 109-263 70.3-70.3 163.7-109 263-109 99.4 0 192.8 38.7 263 109 70.3 70.3 109 163.7 109 263 0 105.6-44.5 205.5-122.6 276zM623.5 421.5a8.03 8.03 0 00-11.3 0L527.7 506c-18.7-5-39.4-.2-54.1 14.5a55.95 55.95 0 000 79.2 55.95 55.95 0 0079.2 0 55.87 55.87 0 0014.5-54.1l84.5-84.5c3.1-3.1 3.1-8.2 0-11.3l-28.3-28.3zM490 320h44c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8h-44c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8zm260 218v44c0 4.4 3.6 8 8 8h80c4.4 0 8-3.6 8-8v-44c0-4.4-3.6-8-8-8h-80c-4.4 0-8 3.6-8 8zm12.7-197.2l-31.1-31.1a8.03 8.03 0 00-11.3 0l-56.6 56.6a8.03 8.03 0 000 11.3l31.1 31.1c3.1 3.1 8.2 3.1 11.3 0l56.6-56.6c3.1-3.1 3.1-8.2 0-11.3zm-458.6-31.1a8.03 8.03 0 00-11.3 0l-31.1 31.1a8.03 8.03 0 000 11.3l56.6 56.6c3.1 3.1 8.2 3.1 11.3 0l31.1-31.1c3.1-3.1 3.1-8.2 0-11.3l-56.6-56.6zM262 530h-80c-4.4 0-8 3.6-8 8v44c0 4.4 3.6 8 8 8h80c4.4 0 8-3.6 8-8v-44c0-4.4-3.6-8-8-8z"}}]},name:"dashboard",theme:"outlined"},xt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M483.2 790.3L861.4 412c1.7-1.7 2.5-4 2.3-6.3l-25.5-301.4c-.7-7.8-6.8-13.9-14.6-14.6L522.2 64.3c-2.3-.2-4.7.6-6.3 2.3L137.7 444.8a8.03 8.03 0 000 11.3l334.2 334.2c3.1 3.2 8.2 3.2 11.3 0zm62.6-651.7l224.6 19 19 224.6L477.5 694 233.9 450.5l311.9-311.9zm60.16 186.23a48 48 0 1067.88-67.89 48 48 0 10-67.88 67.89zM889.7 539.8l-39.6-39.5a8.03 8.03 0 00-11.3 0l-362 361.3-237.6-237a8.03 8.03 0 00-11.3 0l-39.6 39.5a8.03 8.03 0 000 11.3l243.2 242.8 39.6 39.5c3.1 3.1 8.2 3.1 11.3 0l407.3-406.6c3.1-3.1 3.1-8.2 0-11.3z"}}]},name:"tags",theme:"outlined"};const _t={xxl:3,xl:3,lg:3,md:3,sm:2,xs:1},pe=Ye.createContext(null),yt=e=>He(e).map(t=>({...t==null?void 0:t.props,key:t.key}));function gt(e,t,i){const n=u.useMemo(()=>t||yt(i),[t,i]);return u.useMemo(()=>n.map(({span:o,...l})=>o==="filled"?{...l,filled:!0}:{...l,span:typeof o=="number"?o:Pe(e,o)}),[n,e])}function St(e,t){let i=[],n=[],s=!1,o=0;return e.filter(l=>l).forEach(l=>{const{filled:a,...c}=l;if(a){n.push(c),i.push(n),n=[],o=0;return}const m=t-o;o+=l.span||1,o>=t?(o>t?(s=!0,n.push({...c,span:m})):n.push(c),i.push(n),n=[],o=0):n.push(c)}),n.length>0&&i.push(n),i=i.map(l=>{const a=l.reduce((c,m)=>c+(m.span||1),0);if(a<t){const c=l[l.length-1];return c.span=t-(a-(c.span||1)),l}return l}),[i,s]}const wt=(e,t)=>{const[i,n]=u.useMemo(()=>St(t,e),[t,e]);return i},bt=e=>e.children,ae=e=>{const{itemPrefixCls:t,component:i,span:n,className:s,style:o,labelStyle:l,contentStyle:a,bordered:c,label:m,content:d,colon:h,type:x,styles:g,classNames:S}=e,C=i,{classNames:I,styles:p}=u.useContext(pe),[j,f]=Me([I,S],[p,g],{props:e}),y={...l,...f.label},$={...a,...f.content};return c?u.createElement(C,{colSpan:n,style:o,className:P(s,{[`${t}-item-${x}`]:x==="label"||x==="content",[j.label]:j.label&&x==="label",[j.content]:j.content&&x==="content"})},ee(m)&&u.createElement("span",{style:y},m),ee(d)&&u.createElement("span",{style:$},d)):u.createElement(C,{className:P(`${t}-item`,s),style:o,colSpan:n},u.createElement("div",{className:`${t}-item-container`},ee(m)&&u.createElement("span",{style:y,className:P(`${t}-item-label`,j.label,{[`${t}-item-no-colon`]:!h})},m),ee(d)&&u.createElement("span",{style:$,className:P(`${t}-item-content`,j.content)},d)))};function ce(e,{colon:t,prefixCls:i,bordered:n},{component:s,type:o,showLabel:l,showContent:a,labelStyle:c,contentStyle:m,styles:d}){return e.map(({label:h,children:x,prefixCls:g=i,className:S,style:C,labelStyle:I,contentStyle:p,span:j=1,key:f,styles:y,classNames:$},U)=>typeof s=="string"?u.createElement(ae,{key:`${o}-${f||U}`,className:S,style:C,classNames:$,styles:{label:{...c,...d==null?void 0:d.label,...I,...y==null?void 0:y.label},content:{...m,...d==null?void 0:d.content,...p,...y==null?void 0:y.content}},span:j,colon:t,component:s,itemPrefixCls:g,bordered:n,label:l?h:null,content:a?x:null,type:o}):[u.createElement(ae,{key:`label-${f||U}`,className:S,style:{...c,...d==null?void 0:d.label,...C,...I,...y==null?void 0:y.label},span:1,colon:t,component:s[0],itemPrefixCls:g,bordered:n,label:h,type:"label"}),u.createElement(ae,{key:`content-${f||U}`,className:S,style:{...m,...d==null?void 0:d.content,...C,...p,...y==null?void 0:y.content},span:j*2-1,component:s[1],itemPrefixCls:g,bordered:n,content:x,type:"content"})])}const jt=e=>{const t=u.useContext(pe),{prefixCls:i,vertical:n,row:s,index:o,bordered:l}=e;return n?u.createElement(u.Fragment,null,u.createElement("tr",{key:`label-${o}`,className:`${i}-row`},ce(s,e,{component:"th",type:"label",showLabel:!0,...t})),u.createElement("tr",{key:`content-${o}`,className:`${i}-row`},ce(s,e,{component:"td",type:"content",showContent:!0,...t}))):u.createElement("tr",{key:o,className:`${i}-row`},ce(s,e,{component:l?["th","td"]:"td",type:"item",showLabel:!0,showContent:!0,...t}))},zt=e=>{const{componentCls:t,labelBg:i}=e;return{[`&${t}-bordered`]:{[`> ${t}-view`]:{border:`${N(e.lineWidth)} ${e.lineType} ${e.colorSplit}`,"> table":{tableLayout:"auto"},[`${t}-row`]:{borderBottom:`${N(e.lineWidth)} ${e.lineType} ${e.colorSplit}`,"&:first-child":{"> th:first-child, > td:first-child":{borderStartStartRadius:e.borderRadiusLG}},"&:last-child":{borderBottom:"none","> th:first-child, > td:first-child":{borderEndStartRadius:e.borderRadiusLG}},[`> ${t}-item-label, > ${t}-item-content`]:{padding:`${N(e.padding)} ${N(e.paddingLG)}`,borderInlineEnd:`${N(e.lineWidth)} ${e.lineType} ${e.colorSplit}`,"&:last-child":{borderInlineEnd:"none"}},[`> ${t}-item-label`]:{color:e.colorTextSecondary,backgroundColor:i,"&::after":{display:"none"}}}},[`&${t}-middle`]:{[`${t}-row`]:{[`> ${t}-item-label, > ${t}-item-content`]:{padding:`${N(e.paddingSM)} ${N(e.paddingLG)}`}}},[`&${t}-small`]:{[`${t}-row`]:{[`> ${t}-item-label, > ${t}-item-content`]:{padding:`${N(e.paddingXS)} ${N(e.padding)}`}}}}}},Et=e=>{const{componentCls:t,extraColor:i,itemPaddingBottom:n,itemPaddingEnd:s,colonMarginRight:o,colonMarginLeft:l,titleMarginBottom:a}=e;return{[t]:{...Xe(e),...zt(e),"&-rtl":{direction:"rtl"},[`${t}-header`]:{display:"flex",alignItems:"center",marginBottom:a},[`${t}-title`]:{...Ze,flex:"auto",color:e.titleColor,fontWeight:e.fontWeightStrong,fontSize:e.fontSizeLG,lineHeight:e.lineHeightLG},[`${t}-extra`]:{marginInlineStart:"auto",color:i,fontSize:e.fontSize},[`${t}-view`]:{width:"100%",borderRadius:e.borderRadiusLG,table:{width:"100%",tableLayout:"fixed",borderCollapse:"collapse"}},[`${t}-row`]:{"> th, > td":{paddingBottom:n,paddingInlineEnd:s},"> th:last-child, > td:last-child":{paddingInlineEnd:0},"&:last-child":{borderBottom:"none","> th, > td":{paddingBottom:0}}},[`${t}-item-label`]:{color:e.labelColor,fontWeight:"normal",fontSize:e.fontSize,lineHeight:e.lineHeight,textAlign:"start","&::after":{content:'":"',position:"relative",top:-.5,marginInline:`${N(l)} ${N(o)}`},[`&${t}-item-no-colon::after`]:{content:'""'}},[`${t}-item-no-label`]:{"&::after":{margin:0,content:'""'}},[`${t}-item-content`]:{display:"table-cell",flex:1,color:e.contentColor,fontSize:e.fontSize,lineHeight:e.lineHeight,wordBreak:"break-word",overflowWrap:"break-word"},[`${t}-item`]:{paddingBottom:0,verticalAlign:"top","&-container":{display:"flex",[`${t}-item-label`]:{display:"inline-flex",alignItems:"baseline"},[`${t}-item-content`]:{display:"inline-flex",alignItems:"baseline",minWidth:"1em"}}},"&-middle":{[`${t}-row`]:{"> th, > td":{paddingBottom:e.paddingSM}}},"&-small":{[`${t}-row`]:{"> th, > td":{paddingBottom:e.paddingXS}}}}}},Ct=e=>({labelBg:e.colorFillAlter,labelColor:e.colorTextTertiary,titleColor:e.colorText,titleMarginBottom:e.fontSizeSM*e.lineHeightSM,itemPaddingBottom:e.padding,itemPaddingEnd:e.padding,colonMarginRight:e.marginXS,colonMarginLeft:e.marginXXS/2,contentColor:e.colorText,extraColor:e.colorText}),It=We("Descriptions",e=>{const t=Ke(e,{});return Et(t)},Ct),R=e=>{const{prefixCls:t,title:i,extra:n,column:s,colon:o=!0,bordered:l,layout:a,children:c,className:m,rootClassName:d,style:h,size:x,labelStyle:g,contentStyle:S,styles:C,items:I,classNames:p,...j}=e,{getPrefixCls:f,direction:y,className:$,style:U,classNames:Q,styles:M}=Qe("descriptions"),A=f("descriptions",t),se=nt(),xe=u.useMemo(()=>typeof s=="number"?s:Pe(se,{..._t,...s})??3,[se,s]),_e=gt(se,I,c),J=Je(x),Ue=wt(xe,_e),[De,Ve]=It(A),ke={...e,column:xe,items:_e,size:J},[D,V]=Me([Q,p],[M,C],{props:ke}),qe=u.useMemo(()=>({labelStyle:g,contentStyle:S,styles:{label:V.label,content:V.content},classNames:{label:P(D.label),content:P(D.content)}}),[g,S,V.label,V.content,D.label,D.content]);return u.createElement(pe.Provider,{value:qe},u.createElement("div",{className:P(A,$,D.root,{[`${A}-${J}`]:J&&J!=="default",[`${A}-bordered`]:!!l,[`${A}-rtl`]:y==="rtl"},m,d,De,Ve),style:{...U,...V.root,...h},...j},(i||n)&&u.createElement("div",{className:P(`${A}-header`,D.header),style:V.header},i&&u.createElement("div",{className:P(`${A}-title`,D.title),style:V.title},i),n&&u.createElement("div",{className:P(`${A}-extra`,D.extra),style:V.extra},n)),u.createElement("div",{className:`${A}-view`},u.createElement("table",null,u.createElement("tbody",null,Ue.map((Ge,ye)=>u.createElement(jt,{key:ye,index:ye,colon:o,prefixCls:A,vertical:a==="vertical",bordered:l,row:Ge})))))))};R.Item=bt;var vt=function(t,i){return u.createElement(Z,X({},t,{ref:i,icon:ft}))},Te=u.forwardRef(vt),Rt=function(t,i){return u.createElement(Z,X({},t,{ref:i,icon:mt}))},Nt=u.forwardRef(Rt),Mt=function(t,i){return u.createElement(Z,X({},t,{ref:i,icon:ht}))},At=u.forwardRef(Mt),Lt=function(t,i){return u.createElement(Z,X({},t,{ref:i,icon:pt}))},Pt=u.forwardRef(Lt),$t=function(t,i){return u.createElement(Z,X({},t,{ref:i,icon:xt}))},Tt=u.forwardRef($t);const je=["BOOLEAN","INT32","INT64","INT96","FLOAT","DOUBLE","BYTE_ARRAY","FIXED_LEN_BYTE_ARRAY"],ze=["PLAIN","GROUP_VAR_INT","PLAIN_DICTIONARY","RLE","BIT_PACKED","DELTA_BINARY_PACKED","DELTA_LENGTH_BYTE_ARRAY","DELTA_BYTE_ARRAY","RLE_DICTIONARY","BYTE_STREAM_SPLIT"],Ft=["REQUIRED","OPTIONAL","REPEATED"],Bt=["UTF8","MAP","MAP_KEY_VALUE","LIST","ENUM","DECIMAL","DATE","TIME_MILLIS","TIME_MICROS","TIMESTAMP_MILLIS","TIMESTAMP_MICROS","UINT_8","UINT_16","UINT_32","UINT_64","INT_8","INT_16","INT_32","INT_64","JSON","BSON","INTERVAL"],Ot=["UNCOMPRESSED","SNAPPY","GZIP","LZO","BROTLI","LZ4","ZSTD","LZ4_RAW"],Ut=["DATA_PAGE","INDEX_PAGE","DICTIONARY_PAGE","DATA_PAGE_V2"],Dt=["SPHERICAL","VINCENTY","THOMAS","ANDOYER","KARNEY"];function de(e){const t=te(e);if(t.type===1)return{type:"Point",coordinates:ue(e,t)};if(t.type===2)return{type:"LineString",coordinates:fe(e,t)};if(t.type===3)return{type:"Polygon",coordinates:Ee(e,t)};if(t.type===4){const i=[];for(let n=0;n<t.count;n++)i.push(ue(e,te(e)));return{type:"MultiPoint",coordinates:i}}else if(t.type===5){const i=[];for(let n=0;n<t.count;n++)i.push(fe(e,te(e)));return{type:"MultiLineString",coordinates:i}}else if(t.type===6){const i=[];for(let n=0;n<t.count;n++)i.push(Ee(e,te(e)));return{type:"MultiPolygon",coordinates:i}}else if(t.type===7){const i=[];for(let n=0;n<t.count;n++)i.push(de(e));return{type:"GeometryCollection",geometries:i}}else throw new Error(`Unsupported geometry type: ${t.type}`)}function te(e){const{view:t}=e,i=t.getUint8(e.offset++)===1,n=t.getUint32(e.offset,i);e.offset+=4;const s=n%1e3,o=Math.floor(n/1e3);let l=0;s>1&&s<=7&&(l=t.getUint32(e.offset,i),e.offset+=4);let a=2;return o&&a++,o===3&&a++,{littleEndian:i,type:s,dim:a,count:l}}function ue(e,t){const i=[];for(let n=0;n<t.dim;n++){const s=e.view.getFloat64(e.offset,t.littleEndian);e.offset+=8,i.push(s)}return i}function fe(e,t){const i=[];for(let n=0;n<t.count;n++)i.push(ue(e,t));return i}function Ee(e,t){const{view:i}=e,n=[];for(let s=0;s<t.count;s++){const o=i.getUint32(e.offset,t.littleEndian);e.offset+=4,n.push(fe(e,{...t,count:o}))}return n}const Vt=new TextDecoder,kt={timestampFromMilliseconds(e){return new Date(Number(e))},timestampFromMicroseconds(e){return new Date(Number(e/1000n))},timestampFromNanoseconds(e){return new Date(Number(e/1000000n))},dateFromDays(e){return new Date(e*864e5)},stringFromBytes(e){return e&&Vt.decode(e)},geometryFromBytes(e){return e&&de({view:new DataView(e.buffer,e.byteOffset,e.byteLength),offset:0})},geographyFromBytes(e){return e&&de({view:new DataView(e.buffer,e.byteOffset,e.byteLength),offset:0})}};function qt(e){if(!e.length)return 0;let t=0n;for(const n of e)t=t*256n+BigInt(n);const i=e.length*8;return t>=2n**BigInt(i-1)&&(t-=2n**BigInt(i)),Number(t)}function Gt(e){if(!e)return;const t=e[1]<<8|e[0],i=t>>15?-1:1,n=t>>10&31,s=t&1023;return n===0?i*2**-14*(s/1024):n===31?s?NaN:i*(1/0):i*2**(n-15)*(1+s/1024)}function Fe(e,t,i){const n=e[t],s=[];let o=1;if(n.num_children)for(;s.length<n.num_children;){const l=e[t+o],a=Fe(e,t+o,[...i,l.name]);o+=a.count,s.push(a)}return{count:o,element:n,children:s,path:i}}function Yt(e,t){let i=Fe(e,0,[]);const n=[i];for(const s of t){const o=i.children.find(l=>l.element.name===s);if(!o)throw new Error(`parquet schema element not found: ${t}`);n.push(o),i=o}return n}const w={STOP:0,TRUE:1,FALSE:2,BYTE:3,I16:4,I32:5,I64:6,DOUBLE:7,BINARY:8,LIST:9,STRUCT:12};function Ht(e){let t=0;const i={};for(;e.offset<e.view.byteLength;){const[n,s,o]=Oe(e,t);if(t=o,n===w.STOP)break;i[`field_${s}`]=ie(e,n)}return i}function ie(e,t){switch(t){case w.TRUE:return!0;case w.FALSE:return!1;case w.BYTE:return e.view.getInt8(e.offset++);case w.I16:case w.I32:return Be(e);case w.I64:return Kt(e);case w.DOUBLE:{const i=e.view.getFloat64(e.offset,!0);return e.offset+=8,i}case w.BINARY:{const i=me(e),n=new Uint8Array(e.view.buffer,e.view.byteOffset+e.offset,i);return e.offset+=i,n}case w.LIST:{const i=e.view.getUint8(e.offset++),n=i&15;let s=i>>4;s===15&&(s=me(e));const o=n===w.TRUE||n===w.FALSE,l=new Array(s);for(let a=0;a<s;a++)l[a]=o?ie(e,w.BYTE)===1:ie(e,n);return l}case w.STRUCT:{const i={};let n=0;for(;;){const[s,o,l]=Oe(e,n);if(n=l,s===w.STOP)break;i[`field_${o}`]=ie(e,s)}return i}default:throw new Error(`thrift unhandled type: ${t}`)}}function me(e){let t=0,i=0;for(;;){const n=e.view.getUint8(e.offset++);if(t|=(n&127)<<i,!(n&128))return t;i+=7}}function Wt(e){let t=0n,i=0n;for(;;){const n=e.view.getUint8(e.offset++);if(t|=BigInt(n&127)<<i,!(n&128))return t;i+=7n}}function Be(e){const t=me(e);return t>>>1^-(t&1)}function Kt(e){const t=Wt(e);return t>>1n^-(t&1n)}function Oe(e,t){const i=e.view.getUint8(e.offset++),n=i&15;if(n===w.STOP)return[0,0,t];const s=i>>4,o=s?t+s:Be(e);return[n,o,o]}function Zt(e,t){var o,l,a,c,m;const i=new Map,n=(o=t==null?void 0:t.find(({key:d})=>d==="geo"))==null?void 0:o.value,s=(n&&((l=JSON.parse(n))==null?void 0:l.columns))??{};for(const[d,h]of Object.entries(s)){if(h.encoding!=="WKB")continue;const x=h.edges==="spherical"?"GEOGRAPHY":"GEOMETRY",g=((a=h.crs)==null?void 0:a.id)??((m=(c=h.crs)==null?void 0:c.ids)==null?void 0:m[0]),S=g?`${g.authority}:${g.code.toString()}`:void 0;i.set(d,{type:x,crs:S})}for(let d=1;d<e.length;d++){const h=e[d],{logical_type:x,name:g,num_children:S,repetition_type:C,type:I}=h;if(S){d+=S;continue}I==="BYTE_ARRAY"&&x===void 0&&C!=="REPEATED"&&(h.logical_type=i.get(g))}}const Xt=1<<19,Qt=new TextDecoder;function L(e){return e&&Qt.decode(e)}async function Jt(e,{parsers:t,initialFetchSize:i=Xt,geoparquet:n=!0}={}){if(!e||!(e.byteLength>=0))throw new Error("parquet expected AsyncBuffer");const s=Math.max(0,e.byteLength-i),o=await e.slice(s,e.byteLength),l=new DataView(o);if(l.getUint32(o.byteLength-4,!0)!==827474256)throw new Error("parquet file invalid (footer != PAR1)");const a=l.getUint32(o.byteLength-8,!0);if(a>e.byteLength-8)throw new Error(`parquet metadata length ${a} exceeds available buffer ${e.byteLength-8}`);if(a+8>i){const c=e.byteLength-a-8,m=await e.slice(c,s),d=new ArrayBuffer(a+8),h=new Uint8Array(d);return h.set(new Uint8Array(m)),h.set(new Uint8Array(o),s-c),Ce(d,{parsers:t,geoparquet:n})}else return Ce(o,{parsers:t,geoparquet:n})}function Ce(e,{parsers:t,geoparquet:i=!0}={}){var I;if(!(e instanceof ArrayBuffer))throw new Error("parquet expected ArrayBuffer");const n=new DataView(e);if(t={...kt,...t},n.byteLength<8)throw new Error("parquet file is too short");if(n.getUint32(n.byteLength-4,!0)!==827474256)throw new Error("parquet file invalid (footer != PAR1)");const s=n.byteLength-8,o=n.getUint32(s,!0);if(o>n.byteLength-8)throw new Error(`parquet metadata length ${o} exceeds available buffer ${n.byteLength-8}`);const l=s-o,c=Ht({view:n,offset:l}),m=c.field_1,d=c.field_2.map(p=>({type:je[p.field_1],type_length:p.field_2,repetition_type:Ft[p.field_3],name:L(p.field_4),num_children:p.field_5,converted_type:Bt[p.field_6],scale:p.field_7,precision:p.field_8,field_id:p.field_9,logical_type:tn(p.field_10)})),h=d.filter(p=>p.type),x=c.field_3,g=c.field_4.map(p=>{var j;return{columns:p.field_1.map((f,y)=>{var $,U,Q;return{file_path:L(f.field_1),file_offset:f.field_2,meta_data:f.field_3&&{type:je[f.field_3.field_1],encodings:($=f.field_3.field_2)==null?void 0:$.map(M=>ze[M]),path_in_schema:f.field_3.field_3.map(L),codec:Ot[f.field_3.field_4],num_values:f.field_3.field_5,total_uncompressed_size:f.field_3.field_6,total_compressed_size:f.field_3.field_7,key_value_metadata:(U=f.field_3.field_8)==null?void 0:U.map(M=>({key:L(M.field_1),value:L(M.field_2)})),data_page_offset:f.field_3.field_9,index_page_offset:f.field_3.field_10,dictionary_page_offset:f.field_3.field_11,statistics:nn(f.field_3.field_12,h[y],t),encoding_stats:(Q=f.field_3.field_13)==null?void 0:Q.map(M=>({page_type:Ut[M.field_1],encoding:ze[M.field_2],count:M.field_3})),bloom_filter_offset:f.field_3.field_14,bloom_filter_length:f.field_3.field_15,size_statistics:f.field_3.field_16&&{unencoded_byte_array_data_bytes:f.field_3.field_16.field_1,repetition_level_histogram:f.field_3.field_16.field_2,definition_level_histogram:f.field_3.field_16.field_3},geospatial_statistics:f.field_3.field_17&&{bbox:f.field_3.field_17.field_1&&{xmin:f.field_3.field_17.field_1.field_1,xmax:f.field_3.field_17.field_1.field_2,ymin:f.field_3.field_17.field_1.field_3,ymax:f.field_3.field_17.field_1.field_4,zmin:f.field_3.field_17.field_1.field_5,zmax:f.field_3.field_17.field_1.field_6,mmin:f.field_3.field_17.field_1.field_7,mmax:f.field_3.field_17.field_1.field_8},geospatial_types:f.field_3.field_17.field_2}},offset_index_offset:f.field_4,offset_index_length:f.field_5,column_index_offset:f.field_6,column_index_length:f.field_7,crypto_metadata:f.field_8,encrypted_column_metadata:f.field_9}}),total_byte_size:p.field_2,num_rows:p.field_3,sorting_columns:(j=p.field_4)==null?void 0:j.map(f=>({column_idx:f.field_1,descending:f.field_2,nulls_first:f.field_3})),file_offset:p.field_5,total_compressed_size:p.field_6,ordinal:p.field_7}}),S=(I=c.field_5)==null?void 0:I.map(p=>({key:L(p.field_1),value:L(p.field_2)})),C=L(c.field_6);return i&&Zt(d,S),{version:m,schema:d,num_rows:x,row_groups:g,key_value_metadata:S,created_by:C,metadata_length:o}}function en({schema:e}){return Yt(e,[])[0]}function tn(e){return e!=null&&e.field_1?{type:"STRING"}:e!=null&&e.field_2?{type:"MAP"}:e!=null&&e.field_3?{type:"LIST"}:e!=null&&e.field_4?{type:"ENUM"}:e!=null&&e.field_5?{type:"DECIMAL",scale:e.field_5.field_1,precision:e.field_5.field_2}:e!=null&&e.field_6?{type:"DATE"}:e!=null&&e.field_7?{type:"TIME",isAdjustedToUTC:e.field_7.field_1,unit:Ie(e.field_7.field_2)}:e!=null&&e.field_8?{type:"TIMESTAMP",isAdjustedToUTC:e.field_8.field_1,unit:Ie(e.field_8.field_2)}:e!=null&&e.field_10?{type:"INTEGER",bitWidth:e.field_10.field_1,isSigned:e.field_10.field_2}:e!=null&&e.field_11?{type:"NULL"}:e!=null&&e.field_12?{type:"JSON"}:e!=null&&e.field_13?{type:"BSON"}:e!=null&&e.field_14?{type:"UUID"}:e!=null&&e.field_15?{type:"FLOAT16"}:e!=null&&e.field_16?{type:"VARIANT",specification_version:e.field_16.field_1}:e!=null&&e.field_17?{type:"GEOMETRY",crs:L(e.field_17.field_1)}:e!=null&&e.field_18?{type:"GEOGRAPHY",crs:L(e.field_18.field_1),algorithm:Dt[e.field_18.field_2]}:e}function Ie(e){if(e.field_1)return"MILLIS";if(e.field_2)return"MICROS";if(e.field_3)return"NANOS";throw new Error("parquet time unit required")}function nn(e,t,i){return e&&{max:ne(e.field_1,t,i),min:ne(e.field_2,t,i),null_count:e.field_3,distinct_count:e.field_4,max_value:ne(e.field_5,t,i),min_value:ne(e.field_6,t,i),is_max_value_exact:e.field_7,is_min_value_exact:e.field_8}}function ne(e,t,i){const{type:n,converted_type:s,logical_type:o}=t;if(e===void 0)return e;if(n==="BOOLEAN")return e[0]===1;if(n==="BYTE_ARRAY")return i.stringFromBytes(e);const l=new DataView(e.buffer,e.byteOffset,e.byteLength);return n==="FLOAT"&&l.byteLength===4?l.getFloat32(0,!0):n==="DOUBLE"&&l.byteLength===8?l.getFloat64(0,!0):n==="INT32"&&s==="DATE"?i.dateFromDays(l.getInt32(0,!0)):n==="INT64"&&s==="TIMESTAMP_MILLIS"?i.timestampFromMilliseconds(l.getBigInt64(0,!0)):n==="INT64"&&s==="TIMESTAMP_MICROS"?i.timestampFromMicroseconds(l.getBigInt64(0,!0)):n==="INT64"&&(o==null?void 0:o.type)==="TIMESTAMP"&&(o==null?void 0:o.unit)==="NANOS"?i.timestampFromNanoseconds(l.getBigInt64(0,!0)):n==="INT64"&&(o==null?void 0:o.type)==="TIMESTAMP"&&(o==null?void 0:o.unit)==="MICROS"?i.timestampFromMicroseconds(l.getBigInt64(0,!0)):n==="INT64"&&(o==null?void 0:o.type)==="TIMESTAMP"?i.timestampFromMilliseconds(l.getBigInt64(0,!0)):n==="INT32"&&l.byteLength===4?l.getInt32(0,!0):n==="INT64"&&l.byteLength===8?l.getBigInt64(0,!0):s==="DECIMAL"?qt(e)*10**-(t.scale||0):(o==null?void 0:o.type)==="FLOAT16"?Gt(e):e}class ve{static async readMetadataFromFile(t){if(!t.name.toLowerCase().endsWith(".parquet"))throw new Error("File must be a Parquet file (.parquet extension)");const i=await t.arrayBuffer();return this.parseMetadata(i,t.size)}static async readMetadataFromStoredFile(t){if(t.fileType!=="parquet")throw new Error("File is not a Parquet file");if(!(t.content instanceof ArrayBuffer))throw new Error("Parquet file content must be ArrayBuffer");return this.parseMetadata(t.content,t.size)}static async parseMetadata(t,i){try{const n=await Jt(t),s=en(n),o=this.transformSchema(s),l=this.transformRowGroups(n.row_groups||[]),a=this.calculatePerformanceMetrics(l,i);return{numRows:Number(n.num_rows||0),createdBy:n.created_by||"Unknown",version:n.version||1,schema:{children:o},rowGroups:l,keyValueMetadata:this.extractKeyValueMetadata(n),performanceMetrics:a,rawSchema:s}}catch(n){throw n instanceof Error?new Error(`Failed to parse Parquet metadata: ${n.message}`):new Error("Failed to parse Parquet metadata: Unknown error")}}static transformSchema(t){const i=[];if(t&&typeof t=="object"&&"children"in t&&Array.isArray(t.children))for(const n of t.children){const s=n==null?void 0:n.element;i.push({name:(s==null?void 0:s.name)||"unknown",type:this.getPhysicalType(s),logicalType:this.getLogicalType(s),nullable:s.repetition_type!=="REQUIRED",repetition:s.repetition_type||"UNKNOWN",statistics:this.extractColumnStatistics(n),element:s})}return i}static getPhysicalType(t){return t.type?String(t.type).toUpperCase():t.primitive_type?String(t.primitive_type).toUpperCase():"UNKNOWN"}static getLogicalType(t){if(t.converted_type)return String(t.converted_type).toUpperCase();if(t.logicalType){if(typeof t.logicalType=="string")return t.logicalType.toUpperCase();if(t.logicalType.type)return String(t.logicalType.type).toUpperCase()}return"NONE"}static extractColumnStatistics(t){if(!t.statistics)return;const i=t.statistics;return{nullCount:Number(i.null_count||0),distinctCount:i.distinct_count!==void 0?Number(i.distinct_count):void 0,minValue:this.decodeStatValue(i.min),maxValue:this.decodeStatValue(i.max)}}static decodeStatValue(t){if(t!=null){if(typeof t=="number"||typeof t=="bigint")return Number(t);if(typeof t=="string")return t;if(ArrayBuffer.isView(t)||t instanceof ArrayBuffer)try{return new TextDecoder("utf-8").decode(t)}catch{return"[Binary Data]"}return String(t)}}static transformRowGroups(t){return t.map((i,n)=>{const s=this.transformRowGroupColumns(i.columns||[]);return{index:n,numRows:Number(i.num_rows||0),totalByteSize:Number(i.total_byte_size||0),compressedSize:Number(i.total_compressed_size||0),columns:s}})}static transformRowGroupColumns(t){return t.map(i=>{var s;const n=i.meta_data||{};return{name:((s=n.path_in_schema)==null?void 0:s.join("."))||"unknown",codec:this.getCodecName(n.codec),compressedSize:Number(n.total_compressed_size||0),uncompressedSize:Number(n.total_uncompressed_size||0),statistics:this.extractRowGroupColumnStatistics(n.statistics)}})}static getCodecName(t){return typeof t=="string"?t.toUpperCase():typeof t=="number"?{0:"UNCOMPRESSED",1:"SNAPPY",2:"GZIP",3:"LZO",4:"BROTLI",5:"LZ4",6:"ZSTD"}[t]||`UNKNOWN (${t})`:"UNKNOWN"}static extractRowGroupColumnStatistics(t){if(t)return{nullCount:Number(t.null_count||0),distinctCount:t.distinct_count!==void 0?Number(t.distinct_count):void 0,minValue:this.decodeStatValue(t.min),maxValue:this.decodeStatValue(t.max)}}static calculatePerformanceMetrics(t,i){const n=t.reduce((a,c)=>a+c.totalByteSize,0),s=t.reduce((a,c)=>a+c.compressedSize,0),o=n>0?n/s:1,l=t.length>0?s/t.length:0;return{totalUncompressedSize:n,totalCompressedSize:s,compressionRatio:o,estimatedMemoryFootprint:Math.max(n,i),avgRowGroupSize:l,numRowGroups:t.length}}static extractKeyValueMetadata(t){const i={};if(t.key_value_metadata&&Array.isArray(t.key_value_metadata))for(const n of t.key_value_metadata)n.key&&n.value!==void 0&&(i[n.key]=String(n.value));return i}}function rn(){const[e,t]=u.useState(null),[i,n]=u.useState(!1),[s,o]=u.useState(null),l=u.useCallback(async m=>{try{n(!0),o(null);const d=await ve.readMetadataFromFile(m);return t(d),d}catch(d){const h=d instanceof Error?d.message:"Failed to read metadata from file";throw o(h),t(null),d}finally{n(!1)}},[]),a=u.useCallback(async m=>{try{n(!0),o(null);const d=await ve.readMetadataFromStoredFile(m);return t(d),d}catch(d){const h=d instanceof Error?d.message:"Failed to read metadata from stored file";throw o(h),t(null),d}finally{n(!1)}},[]),c=u.useCallback(()=>{t(null),o(null)},[]);return{metadata:e,loading:i,error:s,loadFromLocalFile:l,loadFromStoredFile:a,clear:c}}const{Text:Re}=k,sn=({value:e,onChange:t})=>r.jsxs(_,{orientation:"vertical",size:"small",style:{width:"100%",marginBottom:16},children:[r.jsx(Re,{strong:!0,children:"Select File Source"}),r.jsxs(oe.Group,{value:e,onChange:i=>t(i.target.value),buttonStyle:"solid",children:[r.jsx(oe.Button,{value:"uploaded",children:r.jsxs(_,{size:"small",children:[r.jsx(Ae,{}),r.jsx("span",{children:"Uploaded Files"})]})}),r.jsx(oe.Button,{value:"local",children:r.jsxs(_,{size:"small",children:[r.jsx(Nt,{}),r.jsx("span",{children:"Local File"})]})})]}),r.jsx(Re,{type:"secondary",style:{fontSize:12},children:e==="uploaded"?"Select from files already uploaded to the app":"Select a Parquet file from your computer (no upload required)"})]}),{Text:re}=k,on=({onFileSelect:e})=>{const{token:t}=H.useToken(),[i,n]=u.useState(null),[s,o]=u.useState(!1),l=u.useCallback(async d=>{if(d.length===0)return;const h=d[0];if(!h.name.toLowerCase().endsWith(".parquet")){W.error("Please select a Parquet file (.parquet)");return}n(h);try{o(!0),await e(h),W.success("Metadata loaded successfully")}catch(x){console.error("Failed to load metadata:",x),W.error("Failed to load metadata from file")}finally{o(!1)}},[e]),{getRootProps:a,getInputProps:c,isDragActive:m}=it({onDrop:l,accept:{"application/octet-stream":[".parquet"]},multiple:!1,disabled:s});return r.jsxs(b,{...a(),style:{cursor:s?"wait":"pointer",borderStyle:"dashed",borderWidth:2,borderColor:m?t.colorPrimary:t.colorBorder,backgroundColor:m?t.colorPrimaryBg:"transparent",transition:"all 0.3s",marginTop:16},children:[r.jsx("input",{...c()}),r.jsx(_,{orientation:"vertical",align:"center",style:{width:"100%",padding:"24px 0"},children:i?r.jsxs(r.Fragment,{children:[r.jsx(he,{style:{fontSize:48,color:t.colorSuccess}}),r.jsx(re,{strong:!0,style:{fontSize:16},children:i.name}),r.jsxs(_,{size:"small",children:[r.jsx(O,{color:"blue",children:E(i.size)}),r.jsx(O,{color:"green",children:"Selected"})]}),r.jsx(re,{type:"secondary",style:{fontSize:12},children:"Click or drag another file to change selection"})]}):r.jsxs(r.Fragment,{children:[r.jsx(st,{style:{fontSize:48,color:m?t.colorPrimary:t.colorTextDisabled}}),r.jsx(re,{strong:!0,style:{fontSize:16},children:m?"Drop Parquet file here":"Click or drag Parquet file to inspect"}),r.jsxs(_,{size:"small",children:[r.jsx($e,{}),r.jsx(re,{type:"secondary",children:"Parquet files only (*.parquet)"})]})]})})]})},{Text:T}=k,ln=({onFileSelect:e})=>{const{token:t}=H.useToken(),i=et(),{files:n}=ot(),[s,o]=u.useState([]),[l,a]=u.useState(null),[c,m]=u.useState(!1);u.useEffect(()=>{o(n.filter(h=>h.fileType==="parquet"))},[n]);const d=async h=>{a(h.id);try{m(!0),await e(h),W.success("Metadata loaded successfully")}catch(x){console.error("Failed to load metadata:",x),W.error("Failed to load metadata from file"),a(null)}finally{m(!1)}};return s.length===0?r.jsx(K,{image:K.PRESENTED_IMAGE_SIMPLE,description:r.jsxs(_,{orientation:"vertical",size:"small",children:[r.jsx(T,{type:"secondary",children:"No Parquet files uploaded"}),r.jsx(T,{type:"secondary",style:{fontSize:12},children:"Upload Parquet files from the Files page"})]}),style:{padding:"48px 0"},children:r.jsx(ge,{type:"primary",icon:r.jsx(Se,{}),onClick:()=>i("/files"),children:"Go to Files"})}):r.jsxs("div",{style:{marginTop:16},children:[r.jsxs(_,{orientation:"vertical",size:"small",style:{width:"100%",marginBottom:12},children:[r.jsx(T,{strong:!0,children:"Select a Parquet File"}),r.jsx(T,{type:"secondary",style:{fontSize:12},children:"Click on a file to view its metadata"})]}),r.jsx(le,{size:"small",bordered:!0,dataSource:s,style:{maxHeight:400,overflow:"auto"},renderItem:h=>{const x=l===h.id;return r.jsx(le.Item,{style:{cursor:c?"wait":"pointer",backgroundColor:x?t.colorPrimaryBg:"transparent",transition:"background-color 0.2s"},onClick:()=>!c&&d(h),extra:x&&r.jsx(he,{style:{color:t.colorPrimary,fontSize:18}}),children:r.jsx(le.Item.Meta,{avatar:r.jsx($e,{style:{fontSize:24,color:t.colorPrimary}}),title:r.jsx(_,{children:r.jsx(T,{strong:x,children:h.name})}),description:r.jsxs(_,{size:"small",children:[r.jsx(T,{type:"secondary",style:{fontSize:12},children:E(h.size)}),r.jsx(T,{type:"secondary",style:{fontSize:12},children:"â€¢"}),r.jsx(T,{type:"secondary",style:{fontSize:12},children:new Date(h.uploadedAt).toLocaleDateString()})]})})})}}),r.jsxs(_,{style:{marginTop:12,width:"100%",justifyContent:"space-between"},children:[r.jsxs(T,{type:"secondary",style:{fontSize:12},children:[s.length," file",s.length!==1?"s":""," available"]}),r.jsx(ge,{size:"small",icon:r.jsx(Se,{}),onClick:()=>i("/files"),children:"Manage Files"})]})]})},{Text:F}=k,an=({columns:e})=>{const{token:t}=H.useToken(),i=[{title:"Column Name",dataIndex:"name",key:"name",fixed:"left",width:200,render:n=>r.jsx(F,{strong:!0,children:n}),sorter:(n,s)=>n.name.localeCompare(s.name)},{title:"Physical Type",dataIndex:"type",key:"type",width:150,render:n=>r.jsx(O,{color:"blue",children:n}),sorter:(n,s)=>n.type.localeCompare(s.type)},{title:"Logical Type",dataIndex:"logicalType",key:"logicalType",width:150,render:n=>r.jsx(O,{color:n==="NONE"?"default":"green",children:n}),sorter:(n,s)=>n.logicalType.localeCompare(s.logicalType)},{title:"Nullable",dataIndex:"nullable",key:"nullable",width:100,align:"center",render:n=>n?r.jsx(he,{style:{color:t.colorSuccess,fontSize:16}}):r.jsx(lt,{style:{color:t.colorError,fontSize:16}}),sorter:(n,s)=>Number(n.nullable)-Number(s.nullable)},{title:"Repetition",dataIndex:"repetition",key:"repetition",width:120,render:n=>{const s=n==="REQUIRED"?"red":n==="REPEATED"?"purple":"default";return r.jsx(O,{color:s,children:n})}},{title:"Null Count",key:"nullCount",width:120,align:"right",render:(n,s)=>{var l;const o=(l=s.statistics)==null?void 0:l.nullCount;return o===void 0?r.jsx(F,{type:"secondary",children:"-"}):r.jsx(F,{type:o>0?"warning":"secondary",children:o.toLocaleString()})},sorter:(n,s)=>{var o,l;return(((o=n.statistics)==null?void 0:o.nullCount)||0)-(((l=s.statistics)==null?void 0:l.nullCount)||0)}},{title:"Min Value",key:"minValue",width:150,render:(n,s)=>{var l;const o=(l=s.statistics)==null?void 0:l.minValue;return o===void 0?r.jsx(F,{type:"secondary",children:"-"}):r.jsx(F,{code:!0,style:{fontSize:12},children:String(o)})}},{title:"Max Value",key:"maxValue",width:150,render:(n,s)=>{var l;const o=(l=s.statistics)==null?void 0:l.maxValue;return o===void 0?r.jsx(F,{type:"secondary",children:"-"}):r.jsx(F,{code:!0,style:{fontSize:12},children:String(o)})}},{title:"Distinct Count",key:"distinctCount",width:140,align:"right",render:(n,s)=>{var l;const o=(l=s.statistics)==null?void 0:l.distinctCount;return o===void 0?r.jsx(F,{type:"secondary",children:"-"}):r.jsx(F,{children:o.toLocaleString()})},sorter:(n,s)=>{var o,l;return(((o=n.statistics)==null?void 0:o.distinctCount)||0)-(((l=s.statistics)==null?void 0:l.distinctCount)||0)}}];return r.jsx(v,{columns:i,dataSource:e.map((n,s)=>({...n,key:s})),pagination:{pageSize:100,showSizeChanger:!0,pageSizeOptions:["50","100","200","500"],showTotal:n=>`Total ${n} columns`},scroll:{x:1200},size:"small",bordered:!0})},{Title:Ne,Text:B}=k,cn=({metadata:e})=>{const{token:t}=H.useToken(),i=e.keyValueMetadata&&Object.keys(e.keyValueMetadata).length>0;return r.jsxs(_,{orientation:"vertical",size:"large",style:{width:"100%"},children:[r.jsx(b,{children:r.jsxs(_,{orientation:"vertical",size:"small",style:{width:"100%"},children:[r.jsxs(_,{children:[r.jsx(Le,{style:{fontSize:18,color:t.colorPrimary}}),r.jsx(Ne,{level:5,style:{margin:0},children:"File Statistics"})]}),r.jsxs(R,{bordered:!0,size:"small",column:2,children:[r.jsx(R.Item,{label:"Total Rows",span:1,children:r.jsx(B,{strong:!0,children:e.numRows.toLocaleString()})}),r.jsx(R.Item,{label:"Total Columns",span:1,children:r.jsx(B,{strong:!0,children:e.schema.children.length.toLocaleString()})}),r.jsx(R.Item,{label:"Created By",span:2,children:r.jsx(B,{code:!0,children:e.createdBy})}),r.jsx(R.Item,{label:"Parquet Version",span:1,children:r.jsx(B,{children:e.version})}),r.jsx(R.Item,{label:"Row Groups",span:1,children:r.jsx(B,{children:e.rowGroups.length.toLocaleString()})}),r.jsx(R.Item,{label:"Total Compressed Size",span:1,children:r.jsx(B,{strong:!0,children:E(e.performanceMetrics.totalCompressedSize)})}),r.jsx(R.Item,{label:"Total Uncompressed Size",span:1,children:r.jsx(B,{children:E(e.performanceMetrics.totalUncompressedSize)})})]})]})}),i&&r.jsx(b,{children:r.jsxs(_,{orientation:"vertical",size:"small",style:{width:"100%"},children:[r.jsxs(_,{children:[r.jsx(Tt,{style:{fontSize:18,color:t.colorSuccess}}),r.jsx(Ne,{level:5,style:{margin:0},children:"Key-Value Metadata"})]}),r.jsx(R,{bordered:!0,size:"small",column:1,children:Object.entries(e.keyValueMetadata).map(([n,s])=>r.jsx(R.Item,{label:n,children:r.jsx(B,{code:!0,children:s})},n))})]})}),!i&&r.jsx(b,{children:r.jsx(K,{image:K.PRESENTED_IMAGE_SIMPLE,description:r.jsx(B,{type:"secondary",children:"No custom key-value metadata found in this file"})})})]})},{Text:z}=k,dn=({rowGroups:e})=>{const{token:t}=H.useToken(),i=[{title:"Row Group",dataIndex:"index",key:"index",width:120,render:l=>r.jsxs(z,{strong:!0,children:["Group #",l]})},{title:"Rows",dataIndex:"numRows",key:"numRows",width:150,align:"right",render:l=>r.jsx(z,{children:l.toLocaleString()}),sorter:(l,a)=>l.numRows-a.numRows},{title:"Total Size",dataIndex:"totalByteSize",key:"totalByteSize",width:150,align:"right",render:l=>r.jsx(z,{children:E(l)}),sorter:(l,a)=>l.totalByteSize-a.totalByteSize},{title:"Compressed Size",dataIndex:"compressedSize",key:"compressedSize",width:180,align:"right",render:l=>r.jsx(z,{strong:!0,children:E(l)}),sorter:(l,a)=>l.compressedSize-a.compressedSize},{title:"Compression Ratio",key:"compressionRatio",width:180,align:"right",render:(l,a)=>{const c=a.compressedSize>0?a.totalByteSize/a.compressedSize:1,m=c>=3?"green":c>=2?"blue":"default";return r.jsxs(O,{color:m,children:[c.toFixed(2),"x"]})},sorter:(l,a)=>{const c=l.compressedSize>0?l.totalByteSize/l.compressedSize:1,m=a.compressedSize>0?a.totalByteSize/a.compressedSize:1;return c-m}},{title:"Columns",key:"columns",width:100,align:"center",render:(l,a)=>r.jsx(z,{type:"secondary",children:a.columns.length})}],n=l=>{const a=[{title:"Column Name",dataIndex:"name",key:"name",render:c=>r.jsx(z,{code:!0,children:c})},{title:"Codec",dataIndex:"codec",key:"codec",width:150,render:c=>{const m=c==="UNCOMPRESSED"?"default":"blue";return r.jsx(O,{color:m,children:c})}},{title:"Compressed Size",dataIndex:"compressedSize",key:"compressedSize",width:150,align:"right",render:c=>r.jsx(z,{children:E(c)})},{title:"Uncompressed Size",dataIndex:"uncompressedSize",key:"uncompressedSize",width:180,align:"right",render:c=>r.jsx(z,{children:E(c)})},{title:"Ratio",key:"ratio",width:100,align:"right",render:(c,m)=>{const d=m.compressedSize>0?m.uncompressedSize/m.compressedSize:1;return r.jsxs(z,{children:[d.toFixed(2),"x"]})}}];return r.jsx(v,{columns:a,dataSource:l.columns.map((c,m)=>({...c,key:m})),pagination:!1,size:"small"})},s=e.reduce((l,a)=>({totalRows:l.totalRows+a.numRows,totalSize:l.totalSize+a.totalByteSize,totalCompressed:l.totalCompressed+a.compressedSize}),{totalRows:0,totalSize:0,totalCompressed:0}),o=s.totalCompressed>0?s.totalSize/s.totalCompressed:1;return r.jsx(_,{orientation:"vertical",size:"large",style:{width:"100%"},children:r.jsx(v,{columns:i,dataSource:e.map(l=>({...l,key:l.index})),expandable:{expandedRowRender:n,rowExpandable:()=>!0},pagination:{pageSize:50,showSizeChanger:!0,pageSizeOptions:["20","50","100"],showTotal:l=>`Total ${l} row groups`},size:"small",bordered:!0,summary:()=>r.jsx(v.Summary,{fixed:!0,children:r.jsxs(v.Summary.Row,{style:{backgroundColor:t.colorFillAlter},children:[r.jsx(v.Summary.Cell,{index:0,children:r.jsx(z,{strong:!0,children:"Total"})}),r.jsx(v.Summary.Cell,{index:1,align:"right",children:r.jsx(z,{strong:!0,children:s.totalRows.toLocaleString()})}),r.jsx(v.Summary.Cell,{index:2,align:"right",children:r.jsx(z,{strong:!0,children:E(s.totalSize)})}),r.jsx(v.Summary.Cell,{index:3,align:"right",children:r.jsx(z,{strong:!0,children:E(s.totalCompressed)})}),r.jsx(v.Summary.Cell,{index:4,align:"right",children:r.jsxs(O,{color:o>=3?"green":o>=2?"blue":"default",children:[o.toFixed(2),"x"]})}),r.jsx(v.Summary.Cell,{index:5,align:"center",children:r.jsx(z,{type:"secondary",children:"-"})})]})})})})},{Title:un,Text:Y}=k,fn=({metrics:e})=>{const{token:t}=H.useToken(),n=(s=>s>=4?{label:"Excellent",color:t.colorSuccess,percent:100}:s>=3?{label:"Very Good",color:t.colorSuccessActive,percent:85}:s>=2?{label:"Good",color:t.colorPrimary,percent:70}:s>=1.5?{label:"Moderate",color:t.colorWarning,percent:50}:{label:"Poor",color:t.colorError,percent:30})(e.compressionRatio);return r.jsxs(_,{orientation:"vertical",size:"large",style:{width:"100%"},children:[r.jsxs(be,{gutter:[16,16],children:[r.jsx(G,{xs:24,sm:12,lg:6,children:r.jsxs(b,{children:[r.jsx(q,{title:"Uncompressed Size",value:E(e.totalUncompressedSize),prefix:r.jsx(Ae,{}),styles:{content:{color:t.colorPrimary,fontSize:20}}}),r.jsx(Y,{type:"secondary",style:{fontSize:12},children:"Total size of all data uncompressed"})]})}),r.jsx(G,{xs:24,sm:12,lg:6,children:r.jsxs(b,{children:[r.jsx(q,{title:"Compressed Size",value:E(e.totalCompressedSize),prefix:r.jsx(At,{}),styles:{content:{color:t.colorSuccess,fontSize:20}}}),r.jsx(Y,{type:"secondary",style:{fontSize:12},children:"Actual storage size on disk"})]})}),r.jsx(G,{xs:24,sm:12,lg:6,children:r.jsxs(b,{children:[r.jsx(q,{title:"Estimated Memory",value:E(e.estimatedMemoryFootprint),prefix:r.jsx(at,{}),styles:{content:{color:t.colorLink,fontSize:20}}}),r.jsx(Y,{type:"secondary",style:{fontSize:12},children:"Approximate memory needed to load"})]})}),r.jsx(G,{xs:24,sm:12,lg:6,children:r.jsxs(b,{children:[r.jsx(q,{title:"Avg Row Group Size",value:E(e.avgRowGroupSize),prefix:r.jsx(Te,{}),styles:{content:{color:t.colorWarning,fontSize:20}}}),r.jsx(Y,{type:"secondary",style:{fontSize:12},children:"Average compressed row group size"})]})})]}),r.jsx(b,{children:r.jsxs(_,{orientation:"vertical",size:"middle",style:{width:"100%"},children:[r.jsxs("div",{children:[r.jsx(un,{level:5,style:{marginBottom:8},children:"Compression Efficiency"}),r.jsxs(_,{size:"large",children:[r.jsx(q,{title:"Compression Ratio",value:e.compressionRatio.toFixed(2),suffix:"x",styles:{content:{color:n.color,fontSize:32,fontWeight:"bold"}}}),r.jsxs("div",{style:{flex:1,minWidth:200},children:[r.jsx(Y,{type:"secondary",style:{fontSize:12},children:"Quality Assessment"}),r.jsx("div",{style:{marginTop:8},children:r.jsx(ct,{percent:n.percent,strokeColor:n.color,format:()=>r.jsx(O,{color:n.color,style:{border:"none"},children:n.label})})})]})]})]}),r.jsxs(be,{gutter:16,children:[r.jsx(G,{span:12,children:r.jsx(b,{size:"small",style:{backgroundColor:t.colorPrimaryBg},children:r.jsx(q,{title:"Space Saved",value:((1-e.totalCompressedSize/e.totalUncompressedSize)*100).toFixed(1),suffix:"%",styles:{content:{color:t.colorPrimary,fontSize:24}}})})}),r.jsx(G,{span:12,children:r.jsx(b,{size:"small",style:{backgroundColor:t.colorSuccessBg},children:r.jsx(q,{title:"Row Groups",value:e.numRowGroups.toLocaleString(),styles:{content:{color:t.colorSuccess,fontSize:24}}})})})]}),r.jsx(Y,{type:"secondary",style:{fontSize:12},children:"Higher compression ratios indicate better storage efficiency. A ratio of 1x means no compression. Ratios above 3x are considered excellent for Parquet files."})]})})]})},mn=({metadata:e,loading:t,error:i})=>{if(t)return r.jsx(b,{children:r.jsx(tt,{size:"large",tip:"Reading Parquet metadata...",children:r.jsx("div",{style:{minHeight:200}})})});if(i)return r.jsx(ut,{message:"Failed to Load Metadata",description:i,type:"error",showIcon:!0});if(!e)return r.jsx(b,{children:r.jsx(K,{description:"Select a Parquet file to view its metadata",style:{padding:48}})});const n=[{key:"columns",label:r.jsxs("span",{children:[r.jsx(we,{}),"Columns"]}),children:r.jsx(an,{columns:e.schema.children})},{key:"fileInfo",label:r.jsxs("span",{children:[r.jsx(Le,{}),"File Info"]}),children:r.jsx(cn,{metadata:e})},{key:"rowGroups",label:r.jsxs("span",{children:[r.jsx(Te,{}),"Row Groups"]}),children:r.jsx(dn,{rowGroups:e.rowGroups})},{key:"performance",label:r.jsxs("span",{children:[r.jsx(Pt,{}),"Performance"]}),children:r.jsx(fn,{metrics:e.performanceMetrics})},{key:"schema",label:r.jsxs("span",{children:[r.jsx(we,{}),"Schema"]}),children:r.jsx(dt,{object:e.rawSchema})}];return r.jsx(b,{children:r.jsx(rt,{defaultActiveKey:"columns",items:n,size:"large",tabBarStyle:{marginBottom:24}})})},{Title:hn,Paragraph:pn}=k,vn=()=>{const[e,t]=u.useState("uploaded"),{metadata:i,loading:n,error:s,loadFromLocalFile:o,loadFromStoredFile:l}=rn(),a=async m=>{await o(m)},c=async m=>{await l(m)};return r.jsxs(_,{orientation:"vertical",size:"large",style:{width:"100%",padding:24},children:[r.jsxs("div",{children:[r.jsx(hn,{level:2,children:"Parquet Metadata Viewer"}),r.jsx(pn,{type:"secondary",children:"Inspect Parquet file metadata including schema, row groups, and compression statistics without loading the full file into memory."})]}),r.jsxs(b,{title:"Select File",children:[r.jsx(sn,{value:e,onChange:t}),e==="local"?r.jsx(on,{onFileSelect:a}):r.jsx(ln,{onFileSelect:c})]}),r.jsx(mn,{metadata:i,loading:n,error:s})]})};export{vn as default};
