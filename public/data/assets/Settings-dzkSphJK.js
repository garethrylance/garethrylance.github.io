import{r as d,g as we,m as Ce,e as je,d as $e,f as ke,a as I,aZ as De,au as Me,a0 as Ae,Z as ve,a1 as pe,ax as Le,a3 as P,F as Qe,aG as Pe,a4 as Ne,aJ as Fe,bj as Oe,I as he,k as ge,w as Be,n as e,S as C,s as be,l as He,v as We,B as T,q as Ve,aa as Xe}from"./index-esDgJzKA.js";import{N as _e,d as f,C as K,I as ie,s as x,f as H,T as ye,S as fe,M as L}from"./fileValidation-rsoIHyRN.js";import{R as Y,C as R,a as Ue}from"./row-DRyYDKPg.js";import{D as ce}from"./index-CejKotvS.js";import{A as Se,R as W}from"./DeleteOutlined-CSu-kmEn.js";import{R as xe}from"./ReloadOutlined-h7eeqlKk.js";import{R as Ge}from"./CheckOutlined-DpsTZOVh.js";var Je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M766.4 744.3c43.7 0 79.4-36.2 79.4-80.5 0-53.5-79.4-140.8-79.4-140.8S687 610.3 687 663.8c0 44.3 35.7 80.5 79.4 80.5zm-377.1-44.1c7.1 7.1 18.6 7.1 25.6 0l256.1-256c7.1-7.1 7.1-18.6 0-25.6l-256-256c-.6-.6-1.3-1.2-2-1.7l-78.2-78.2a9.11 9.11 0 00-12.8 0l-48 48a9.11 9.11 0 000 12.8l67.2 67.2-207.8 207.9c-7.1 7.1-7.1 18.6 0 25.6l255.9 256zm12.9-448.6l178.9 178.9H223.4l178.8-178.9zM904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8z"}}]},name:"bg-colors",theme:"outlined"},Ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M632 888H392c-4.4 0-8 3.6-8 8v32c0 17.7 14.3 32 32 32h192c17.7 0 32-14.3 32-32v-32c0-4.4-3.6-8-8-8zM512 64c-181.1 0-328 146.9-328 328 0 121.4 66 227.4 164 284.1V792c0 17.7 14.3 32 32 32h264c17.7 0 32-14.3 32-32V676.1c98-56.7 164-162.7 164-284.1 0-181.1-146.9-328-328-328zm127.9 549.8L604 634.6V752H420V634.6l-35.9-20.8C305.4 568.3 256 484.5 256 392c0-141.4 114.6-256 256-256s256 114.6 256 256c0 92.5-49.4 176.3-128.1 221.8z"}}]},name:"bulb",theme:"outlined"},Ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"};const Ze=n=>{const{value:t,formatter:i,precision:a,decimalSeparator:g,groupSeparator:o="",prefixCls:r}=n;let c;if(typeof i=="function")c=i(t);else{const l=String(t),m=l.match(/^(-?)(\d*)(\.(\d+))?$/);if(!m||l==="-")c=l;else{const p=m[1];let y=m[2]||"0",S=m[4]||"";y=y.replace(/\B(?=(\d{3})+(?!\d))/g,o),typeof a=="number"&&(S=S.padEnd(a,"0").slice(0,a>0?a:0)),S&&(S=`${g}${S}`),c=[d.createElement("span",{key:"int",className:`${r}-content-value-int`},p,y),S&&d.createElement("span",{key:"decimal",className:`${r}-content-value-decimal`},S)]}}return d.createElement("span",{className:`${r}-content-value`},c)},et=n=>{const{componentCls:t,marginXXS:i,padding:a,colorTextDescription:g,titleFontSize:o,colorTextHeading:r,contentFontSize:c,fontFamily:l}=n;return{[t]:{...je(n),[`${t}-header`]:{paddingBottom:i,[`${t}-title`]:{color:g,fontSize:o}},[`${t}-skeleton`]:{paddingTop:a},[`${t}-content`]:{color:r,fontSize:c,fontFamily:l,[`${t}-content-value`]:{display:"inline-block",direction:"ltr"},[`${t}-content-prefix, ${t}-content-suffix`]:{display:"inline-block"},[`${t}-content-prefix`]:{marginInlineEnd:i},[`${t}-content-suffix`]:{marginInlineStart:i}}}}},tt=n=>{const{fontSizeHeading3:t,fontSize:i}=n;return{titleFontSize:i,contentFontSize:t}},at=we("Statistic",n=>{const t=Ce(n,{});return et(t)},tt),M=d.forwardRef((n,t)=>{const{prefixCls:i,className:a,rootClassName:g,style:o,valueStyle:r,value:c=0,title:l,valueRender:m,prefix:p,suffix:y,loading:S=!1,formatter:u,precision:s,decimalSeparator:j=".",groupSeparator:v=",",onMouseEnter:z,onMouseLeave:N,styles:F,classNames:O,...w}=n,{getPrefixCls:E,direction:b,className:X,style:_,classNames:B,styles:$}=$e("statistic"),h=E("statistic",i),[q,ne]=at(h),Z={...n,decimalSeparator:j,groupSeparator:v,loading:S,value:c},[A,D]=ke([B,O],[$,F],{props:Z}),U=d.createElement(Ze,{decimalSeparator:j,groupSeparator:v,prefixCls:h,formatter:u,precision:s,value:c}),se=I(h,{[`${h}-rtl`]:b==="rtl"},X,a,g,A.root,q,ne),le=I(`${h}-header`,A.header),re=I(`${h}-title`,A.title),ee=I(`${h}-content`,A.content),ze=I(`${h}-content-prefix`,A.prefix),Ee=I(`${h}-content-suffix`,A.suffix),me=d.useRef(null);d.useImperativeHandle(t,()=>({nativeElement:me.current}));const qe=De(w,{aria:!0,data:!0});return d.createElement("div",{...qe,className:se,style:{...D.root,..._,...o},ref:me,onMouseEnter:z,onMouseLeave:N},l&&d.createElement("div",{className:le,style:D.header},d.createElement("div",{className:re,style:D.title},l)),d.createElement(_e,{paragraph:!1,loading:S,className:`${h}-skeleton`,active:!0},d.createElement("div",{className:ee,style:{...r,...D.content}},p&&d.createElement("span",{className:ze,style:D.prefix},p),m?m(U):U,y&&d.createElement("span",{className:Ee,style:D.suffix},y))))}),nt=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function st(n,t){let i=n;const a=/\[[^\]]*]/g,g=(t.match(a)||[]).map(l=>l.slice(1,-1)),o=t.replace(a,"[]"),r=nt.reduce((l,[m,p])=>{if(l.includes(m)){const y=Math.floor(i/p);return i-=y*p,l.replace(new RegExp(`${m}+`,"g"),S=>{const u=S.length;return y.toString().padStart(u,"0")})}return l},o);let c=0;return r.replace(a,()=>{const l=g[c];return c+=1,l})}function lt(n,t,i){const{format:a=""}=t,g=new Date(n).getTime(),o=Date.now(),r=Math.max(i?g-o:o-g,0);return st(r,a)}const rt=1e3/60;function it(n){return new Date(n).getTime()}const Te=n=>{const{value:t,format:i="HH:mm:ss",onChange:a,onFinish:g,type:o,...r}=n,c=o==="countdown",[l,m]=d.useState(null),p=Me(()=>{const u=Date.now(),s=it(t);m({});const j=c?s-u:u-s;return a==null||a(j),c&&s<u?(g==null||g(),!1):!0});d.useEffect(()=>{let u;const s=()=>{p()||window.clearInterval(u)},j=()=>{u=window.setInterval(s,rt)},v=()=>{window.clearInterval(u)};return j(),()=>{v()}},[t,c]),d.useEffect(()=>{m({})},[]);const y=(u,s)=>l?lt(u,{...s,format:i},c):"-",S=u=>Ae(u,{title:void 0});return d.createElement(M,{...r,value:t,valueRender:S,formatter:y})},ct=n=>d.createElement(Te,{...n,type:"countdown"}),ot=d.memo(ct);M.Timer=Te;M.Countdown=ot;function de(){return de=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n},de.apply(this,arguments)}const Ie=d.forwardRef(({prefixCls:n="rc-switch",className:t,checked:i,defaultChecked:a,disabled:g,loadingIcon:o,checkedChildren:r,unCheckedChildren:c,onClick:l,onChange:m,onKeyDown:p,styles:y,classNames:S,...u},s)=>{const[j,v]=ve(a??!1,i);function z(w,E){let b=j;return g||(b=w,v(b),m==null||m(b,E)),b}function N(w){w.which===pe.LEFT?z(!1,w):w.which===pe.RIGHT&&z(!0,w),p==null||p(w)}function F(w){const E=z(!j,w);l==null||l(E,w)}const O=I(n,t,{[`${n}-checked`]:j,[`${n}-disabled`]:g});return d.createElement("button",de({},u,{type:"button",role:"switch","aria-checked":j,disabled:g,className:O,ref:s,onKeyDown:N,onClick:F}),o,d.createElement("span",{className:`${n}-inner`},d.createElement("span",{className:I(`${n}-inner-checked`,S==null?void 0:S.content),style:y==null?void 0:y.content},r),d.createElement("span",{className:I(`${n}-inner-unchecked`,S==null?void 0:S.content),style:y==null?void 0:y.content},c)))});Ie.displayName="Switch";const dt=n=>{const{componentCls:t,trackHeightSM:i,trackPadding:a,trackMinWidthSM:g,innerMinMarginSM:o,innerMaxMarginSM:r,handleSizeSM:c,calc:l}=n,m=`${t}-inner`,p=P(l(c).add(l(a).mul(2)).equal()),y=P(l(r).mul(2).equal());return{[t]:{[`&${t}-small`]:{minWidth:g,height:i,lineHeight:P(i),[`${t}-inner`]:{paddingInlineStart:r,paddingInlineEnd:o,[`${m}-checked, ${m}-unchecked`]:{minHeight:i},[`${m}-checked`]:{marginInlineStart:`calc(-100% + ${p} - ${y})`,marginInlineEnd:`calc(100% - ${p} + ${y})`},[`${m}-unchecked`]:{marginTop:l(i).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`${t}-handle`]:{width:c,height:c},[`${t}-loading-icon`]:{top:l(l(c).sub(n.switchLoadingIconSize)).div(2).equal(),fontSize:n.switchLoadingIconSize},[`&${t}-checked`]:{[`${t}-inner`]:{paddingInlineStart:o,paddingInlineEnd:r,[`${m}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${m}-unchecked`]:{marginInlineStart:`calc(100% - ${p} + ${y})`,marginInlineEnd:`calc(-100% + ${p} - ${y})`}},[`${t}-handle`]:{insetInlineStart:`calc(100% - ${P(l(c).add(a).equal())})`}},[`&:not(${t}-disabled):active`]:{[`&:not(${t}-checked) ${m}`]:{[`${m}-unchecked`]:{marginInlineStart:l(n.marginXXS).div(2).equal(),marginInlineEnd:l(n.marginXXS).mul(-1).div(2).equal()}},[`&${t}-checked ${m}`]:{[`${m}-checked`]:{marginInlineStart:l(n.marginXXS).mul(-1).div(2).equal(),marginInlineEnd:l(n.marginXXS).div(2).equal()}}}}}}},ut=n=>{const{componentCls:t,handleSize:i,calc:a}=n;return{[t]:{[`${t}-loading-icon${n.iconCls}`]:{position:"relative",top:a(a(i).sub(n.fontSize)).div(2).equal(),color:n.switchLoadingIconColor,verticalAlign:"top"},[`&${t}-checked ${t}-loading-icon`]:{color:n.switchColor}}}},ht=n=>{const{componentCls:t,trackPadding:i,handleBg:a,handleShadow:g,handleSize:o,calc:r}=n,c=`${t}-handle`;return{[t]:{[c]:{position:"absolute",top:i,insetInlineStart:i,width:o,height:o,transition:`all ${n.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:a,borderRadius:r(o).div(2).equal(),boxShadow:g,transition:`all ${n.switchDuration} ease-in-out`,content:'""'}},[`&${t}-checked ${c}`]:{insetInlineStart:`calc(100% - ${P(r(o).add(i).equal())})`},[`&:not(${t}-disabled):active`]:{[`${c}::before`]:{insetInlineEnd:n.switchHandleActiveInset,insetInlineStart:0},[`&${t}-checked ${c}::before`]:{insetInlineEnd:0,insetInlineStart:n.switchHandleActiveInset}}}}},gt=n=>{const{componentCls:t,trackHeight:i,trackPadding:a,innerMinMargin:g,innerMaxMargin:o,handleSize:r,calc:c}=n,l=`${t}-inner`,m=P(c(r).add(c(a).mul(2)).equal()),p=P(c(o).mul(2).equal());return{[t]:{[l]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:o,paddingInlineEnd:g,transition:`padding-inline-start ${n.switchDuration} ease-in-out, padding-inline-end ${n.switchDuration} ease-in-out`,[`${l}-checked, ${l}-unchecked`]:{display:"block",color:n.colorTextLightSolid,fontSize:n.fontSizeSM,transition:`margin-inline-start ${n.switchDuration} ease-in-out, margin-inline-end ${n.switchDuration} ease-in-out`,pointerEvents:"none",minHeight:i},[`${l}-checked`]:{marginInlineStart:`calc(-100% + ${m} - ${p})`,marginInlineEnd:`calc(100% - ${m} + ${p})`},[`${l}-unchecked`]:{marginTop:c(i).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`&${t}-checked ${l}`]:{paddingInlineStart:g,paddingInlineEnd:o,[`${l}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${l}-unchecked`]:{marginInlineStart:`calc(100% - ${m} + ${p})`,marginInlineEnd:`calc(-100% + ${m} - ${p})`}},[`&:not(${t}-disabled):active`]:{[`&:not(${t}-checked) ${l}`]:{[`${l}-unchecked`]:{marginInlineStart:c(a).mul(2).equal(),marginInlineEnd:c(a).mul(-1).mul(2).equal()}},[`&${t}-checked ${l}`]:{[`${l}-checked`]:{marginInlineStart:c(a).mul(-1).mul(2).equal(),marginInlineEnd:c(a).mul(2).equal()}}}}}},mt=n=>{const{componentCls:t,trackHeight:i,trackMinWidth:a}=n;return{[t]:{...je(n),position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:a,height:i,lineHeight:P(i),verticalAlign:"middle",background:n.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${n.motionDurationMid}`,userSelect:"none",[`&:hover:not(${t}-disabled)`]:{background:n.colorTextTertiary},...Le(n),[`&${t}-checked`]:{background:n.switchColor,[`&:hover:not(${t}-disabled)`]:{background:n.colorPrimaryHover}},[`&${t}-loading, &${t}-disabled`]:{cursor:"not-allowed",opacity:n.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${t}-rtl`]:{direction:"rtl"}}}},pt=n=>{const{fontSize:t,lineHeight:i,controlHeight:a,colorWhite:g}=n,o=t*i,r=a/2,c=2,l=o-c*2,m=r-c*2;return{trackHeight:o,trackHeightSM:r,trackMinWidth:l*2+c*4,trackMinWidthSM:m*2+c*2,trackPadding:c,handleBg:g,handleSize:l,handleSizeSM:m,handleShadow:`0 2px 4px 0 ${new Qe("#00230b").setA(.2).toRgbString()}`,innerMinMargin:l/2,innerMaxMargin:l+c+c*2,innerMinMarginSM:m/2,innerMaxMarginSM:m+c+c*2}},yt=we("Switch",n=>{const t=Ce(n,{switchDuration:n.motionDurationMid,switchColor:n.colorPrimary,switchDisabledOpacity:n.opacityLoading,switchLoadingIconSize:n.calc(n.fontSizeIcon).mul(.75).equal(),switchLoadingIconColor:`rgba(0, 0, 0, ${n.opacityLoading})`,switchHandleActiveInset:"-30%"});return[mt(t),gt(t),ht(t),ut(t),dt(t)]},pt),ft=d.forwardRef((n,t)=>{const{prefixCls:i,size:a,disabled:g,loading:o,className:r,rootClassName:c,style:l,checked:m,value:p,defaultChecked:y,defaultValue:S,onChange:u,styles:s,classNames:j,...v}=n,[z,N]=ve(y??S??!1,m??p),{getPrefixCls:F,direction:O,className:w,style:E,classNames:b,styles:X}=$e("switch"),_=d.useContext(Pe),B=(g??_)||o,$=F("switch",i),h=d.createElement("div",{className:`${$}-handle`},o&&d.createElement(Oe,{className:`${$}-loading-icon`})),[q,ne]=yt($),Z=Ne(a),A={...n,size:Z,disabled:B},[D,U]=ke([b,j],[X,s],{props:A}),se=I(w,{[`${$}-small`]:Z==="small",[`${$}-loading`]:o,[`${$}-rtl`]:O==="rtl"},r,c,D.root,q,ne),le={...U.root,...E,...l},re=(...ee)=>{N(ee[0]),u==null||u(...ee)};return d.createElement(Fe,{component:"Switch",disabled:B},d.createElement(Ie,{...v,classNames:D,styles:U,checked:z,onChange:re,prefixCls:$,className:se,style:le,disabled:B,ref:t,loadingIcon:h}))}),Re=ft;Re.__ANT_SWITCH=!0;var St=function(t,i){return d.createElement(he,ge({},t,{ref:i,icon:Je}))},xt=d.forwardRef(St),wt=function(t,i){return d.createElement(he,ge({},t,{ref:i,icon:Ke}))},Ct=d.forwardRef(wt),jt=function(t,i){return d.createElement(he,ge({},t,{ref:i,icon:Ye}))},V=d.forwardRef(jt);class Q{static async getStats(){const t=await f.files.toArray(),i=await f.pythonCode.toArray(),a=await f.executionResults.toArray(),g=await f.sqlQueries.toArray(),o=await f.sqlQueryResults.toArray(),r=t.reduce((u,s)=>u+s.size,0),c=i.reduce((u,s)=>u+this.estimateSize(s.code),0),l=a.reduce((u,s)=>u+this.estimateSize(JSON.stringify(s.result))+this.estimateSize(JSON.stringify(s.consoleOutput))+this.estimateSize(s.codeSnapshot),0),m=g.reduce((u,s)=>u+this.estimateSize(s.query),0),p=o.reduce((u,s)=>u+this.estimateSize(JSON.stringify(s.result))+this.estimateSize(s.querySnapshot),0),y=1024,S=t.reduce((u,s)=>(u[s.fileType]=(u[s.fileType]||0)+1,u),{});return{total:r+c+l+m+p+y,files:r,pythonCode:c,executionResults:l,sqlQueries:m,sqlQueryResults:p,settings:y,fileDetails:t.sort((u,s)=>s.size-u.size).map(u=>({id:u.id,name:u.name,size:u.size,type:u.fileType})),fileTypeCounts:S,counts:{files:t.length,pythonScripts:i.length,pythonResults:a.length,sqlScripts:g.length,sqlResults:o.length}}}static async clearFiles(){await f.transaction("rw",[f.files,f.pythonCode,f.executionResults],async()=>{await f.files.clear(),await f.pythonCode.clear(),await f.executionResults.clear()})}static async clearCode(){await f.pythonCode.clear()}static async clearResults(){await f.executionResults.clear()}static async clearSqlQueries(){await f.sqlQueries.clear()}static async clearSqlResults(){await f.sqlQueryResults.clear()}static async clearAllSqlData(){await f.transaction("rw",[f.sqlQueries,f.sqlQueryResults],async()=>{await f.sqlQueries.clear(),await f.sqlQueryResults.clear()})}static async clearSettings(){await f.pyodideSettings.clear(),await f.pyodideSettings.add({id:"pyodide-settings",packages:["pandas","numpy"],autoDetect:!0})}static async clearAllData(){await f.transaction("rw",[f.files,f.pythonCode,f.executionResults,f.sqlQueries,f.sqlQueryResults,f.pyodideSettings],async()=>{await f.files.clear(),await f.pythonCode.clear(),await f.executionResults.clear(),await f.sqlQueries.clear(),await f.sqlQueryResults.clear(),await f.pyodideSettings.clear(),await f.pyodideSettings.add({id:"pyodide-settings",packages:["pandas","numpy"],autoDetect:!0})})}static estimateSize(t){return t.length*2}static formatBytes(t){if(t===0)return"0 B";const i=1024,a=["B","KB","MB","GB"],g=Math.floor(Math.log(t)/Math.log(i));return`${(t/Math.pow(i,g)).toFixed(1)} ${a[g]}`}}function $t(){const[n,t]=d.useState(null),[i,a]=d.useState(!1),[g,o]=d.useState(null),r=d.useCallback(async()=>{try{a(!0),o(null);const s=await Q.getStats();t(s)}catch(s){console.error("Load stats error:",s),o(s instanceof Error?s.message:"Failed to load storage stats")}finally{a(!1)}},[]);d.useEffect(()=>{r()},[r]);const c=d.useCallback(async()=>{try{a(!0),o(null),await Q.clearFiles(),await r()}catch(s){throw console.error("Clear files error:",s),o(s instanceof Error?s.message:"Failed to clear files"),s}finally{a(!1)}},[r]),l=d.useCallback(async()=>{try{a(!0),o(null),await Q.clearCode(),await r()}catch(s){throw console.error("Clear code error:",s),o(s instanceof Error?s.message:"Failed to clear code"),s}finally{a(!1)}},[r]),m=d.useCallback(async()=>{try{a(!0),o(null),await Q.clearResults(),await r()}catch(s){throw console.error("Clear results error:",s),o(s instanceof Error?s.message:"Failed to clear results"),s}finally{a(!1)}},[r]),p=d.useCallback(async()=>{try{a(!0),o(null),await Q.clearSqlQueries(),await r()}catch(s){throw console.error("Clear SQL queries error:",s),o(s instanceof Error?s.message:"Failed to clear SQL queries"),s}finally{a(!1)}},[r]),y=d.useCallback(async()=>{try{a(!0),o(null),await Q.clearSqlResults(),await r()}catch(s){throw console.error("Clear SQL results error:",s),o(s instanceof Error?s.message:"Failed to clear SQL results"),s}finally{a(!1)}},[r]),S=d.useCallback(async()=>{try{a(!0),o(null),await Q.clearAllSqlData(),await r()}catch(s){throw console.error("Clear all SQL data error:",s),o(s instanceof Error?s.message:"Failed to clear all SQL data"),s}finally{a(!1)}},[r]),u=d.useCallback(async()=>{try{a(!0),o(null),await Q.clearAllData(),await r()}catch(s){throw console.error("Clear all data error:",s),o(s instanceof Error?s.message:"Failed to clear all data"),s}finally{a(!1)}},[r]);return{stats:n,loading:i,error:g,loadStats:r,clearFiles:c,clearCode:l,clearResults:m,clearSqlQueries:p,clearSqlResults:y,clearAllSqlData:S,clearAllData:u}}const oe="pyodide-settings",kt=["pandas","numpy","matplotlib","scipy","scikit-learn","statsmodels","seaborn"];class te{static async getSettings(){let t=await f.pyodideSettings.get(oe);return t||(t={id:oe,packages:["pandas","numpy"],autoDetect:!0},await f.pyodideSettings.put(t)),t}static async updateSettings(t){const a={...await this.getSettings(),...t};return await f.pyodideSettings.put(a),a}static async updatePackages(t){return this.updateSettings({packages:t})}static async updateAutoDetect(t){return this.updateSettings({autoDetect:t})}static async resetToDefaults(){const t={id:oe,packages:["pandas","numpy"],autoDetect:!0};return await f.pyodideSettings.put(t),t}}function vt(){const[n,t]=d.useState(null),[i,a]=d.useState(!1),[g,o]=d.useState(null),r=d.useCallback(async()=>{try{a(!0),o(null);const p=await te.getSettings();t(p)}catch(p){console.error("Load settings error:",p),o(p instanceof Error?p.message:"Failed to load settings")}finally{a(!1)}},[]);d.useEffect(()=>{r()},[r]);const c=d.useCallback(async p=>{try{a(!0),o(null);const y=await te.updatePackages(p);t(y)}catch(y){throw console.error("Update packages error:",y),o(y instanceof Error?y.message:"Failed to update packages"),y}finally{a(!1)}},[]),l=d.useCallback(async p=>{try{a(!0),o(null);const y=await te.updateAutoDetect(p);t(y)}catch(y){throw console.error("Update auto-detect error:",y),o(y instanceof Error?y.message:"Failed to update auto-detect"),y}finally{a(!1)}},[]),m=d.useCallback(async()=>{try{a(!0),o(null);const p=await te.resetToDefaults();t(p)}catch(p){throw console.error("Reset settings error:",p),o(p instanceof Error?p.message:"Failed to reset settings"),p}finally{a(!1)}},[]);return{settings:n,loading:i,error:g,loadSettings:r,updatePackages:c,updateAutoDetect:l,resetToDefaults:m}}const{Text:ue}=be,ae=({name:n,value:t})=>{const i=String(t),a=typeof t=="string"&&(i.startsWith("#")||i.startsWith("rgb")||i.startsWith("hsl"));return e.jsx("div",{style:{marginBottom:12},children:e.jsxs(C,{align:"start",style:{width:"100%"},children:[a&&e.jsx("div",{style:{width:40,height:40,backgroundColor:i,border:"1px solid #d9d9d9",borderRadius:4,flexShrink:0}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx(ue,{strong:!0,style:{display:"block"},children:n}),e.jsx(ue,{type:"secondary",style:{fontSize:12,fontFamily:"monospace",display:"block",wordBreak:"break-all"},children:i})]})]})})},bt=()=>{const{token:n}=Be.useToken(),t={},i={},a={},g={};Object.entries(n).forEach(([r,c])=>{const l=r.toLowerCase();l.includes("color")||l.includes("bg")?t[r]=c:l.includes("size")||l.includes("width")||l.includes("height")||l.includes("margin")||l.includes("padding")||l.includes("radius")?i[r]=c:l.includes("font")||l.includes("line")||l.includes("text")?a[r]=c:g[r]=c});const o=[{key:"colors",label:`Colors & Backgrounds (${Object.keys(t).length})`,children:e.jsx(Y,{gutter:[16,16],children:Object.entries(t).map(([r,c])=>e.jsx(R,{xs:24,sm:12,md:8,lg:6,children:e.jsx(ae,{name:r,value:c})},r))})},{key:"sizes",label:`Sizes & Spacing (${Object.keys(i).length})`,children:e.jsx(Y,{gutter:[16,16],children:Object.entries(i).map(([r,c])=>e.jsx(R,{xs:24,sm:12,md:8,lg:6,children:e.jsx(ae,{name:r,value:c})},r))})},{key:"fonts",label:`Typography (${Object.keys(a).length})`,children:e.jsx(Y,{gutter:[16,16],children:Object.entries(a).map(([r,c])=>e.jsx(R,{xs:24,sm:12,md:8,lg:6,children:e.jsx(ae,{name:r,value:c})},r))})},{key:"other",label:`Other Tokens (${Object.keys(g).length})`,children:e.jsx(Y,{gutter:[16,16],children:Object.entries(g).map(([r,c])=>e.jsx(R,{xs:24,sm:12,md:8,lg:6,children:e.jsx(ae,{name:r,value:c})},r))})}];return e.jsx(K,{title:e.jsxs(C,{children:[e.jsx(xt,{}),"Theme Tokens"]}),children:e.jsxs(C,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsx(ue,{type:"secondary",children:"Explore all design tokens from the current Ant Design theme. These values are automatically generated based on your selected theme (light/dark) and can be used throughout the application."}),e.jsx(Ue,{items:o,defaultActiveKey:[]})]})})},{Title:G,Text:k,Paragraph:J}=be,Tt=()=>{const n=He(),{theme:t,toggleTheme:i}=We(),{stats:a,loading:g,loadStats:o,clearFiles:r,clearCode:c,clearResults:l,clearSqlQueries:m,clearSqlResults:p,clearAllSqlData:y,clearAllData:S}=$t(),{settings:u,loading:s,updatePackages:j,updateAutoDetect:v,resetToDefaults:z}=vt(),N=()=>{L.confirm({title:"Clear All Files",icon:e.jsx(V,{}),content:"This will delete all uploaded files and their associated code and results. This action cannot be undone.",okText:"Clear Files",okType:"danger",onOk:async()=>{try{await r(),x.success("All files cleared successfully")}catch(h){console.error("Clear files error:",h),x.error("Failed to clear files")}}})},F=()=>{L.confirm({title:"Clear All Python Code",icon:e.jsx(V,{}),content:"This will delete all saved Python code. Uploaded files will remain. This action cannot be undone.",okText:"Clear Code",okType:"danger",onOk:async()=>{try{await c(),x.success("All Python code cleared successfully")}catch(h){console.error("Clear code error:",h),x.error("Failed to clear code")}}})},O=()=>{L.confirm({title:"Clear All Results",icon:e.jsx(V,{}),content:"This will delete all execution results. Files and code will remain. This action cannot be undone.",okText:"Clear Results",okType:"danger",onOk:async()=>{try{await l(),x.success("All results cleared successfully")}catch(h){console.error("Clear results error:",h),x.error("Failed to clear results")}}})},w=()=>{L.confirm({title:"Clear SQL Queries",icon:e.jsx(V,{}),content:"This will delete all SQL scripts. Results will remain. This action cannot be undone.",okText:"Clear Queries",okType:"danger",onOk:async()=>{try{await m(),x.success("SQL queries cleared successfully")}catch(h){console.error("Clear SQL queries error:",h),x.error("Failed to clear SQL queries")}}})},E=()=>{L.confirm({title:"Clear SQL Results",icon:e.jsx(V,{}),content:"This will delete all SQL query results. Queries will remain. This action cannot be undone.",okText:"Clear Results",okType:"danger",onOk:async()=>{try{await p(),x.success("SQL results cleared successfully")}catch(h){console.error("Clear SQL results error:",h),x.error("Failed to clear SQL results")}}})},b=()=>{L.confirm({title:"Clear All SQL Data",icon:e.jsx(V,{}),content:"This will delete all SQL scripts and results. This action cannot be undone.",okText:"Clear SQL Data",okType:"danger",onOk:async()=>{try{await y(),x.success("All SQL data cleared successfully")}catch(h){console.error("Clear all SQL data error:",h),x.error("Failed to clear all SQL data")}}})},X=()=>{L.confirm({title:"Clear All Data",icon:e.jsx(V,{}),content:"This will delete ALL data including files, code, SQL scripts, and results. Settings will be reset to defaults. This action cannot be undone.",okText:"Clear Everything",okType:"danger",onOk:async()=>{try{await S(),x.success("All data cleared successfully")}catch(h){console.error("Clear all data error:",h),x.error("Failed to clear all data")}}})},_=async h=>{try{await v(h),x.success(`Auto-detect ${h?"enabled":"disabled"}`)}catch(q){console.error("Update auto-detect error:",q),x.error("Failed to update auto-detect setting")}},B=async h=>{try{await j(h),x.success("Packages updated successfully")}catch(q){console.error("Update packages error:",q),x.error("Failed to update packages")}},$=()=>{L.confirm({title:"Reset to Defaults",content:"This will reset Python package settings to default values (pandas, numpy with auto-detect enabled).",okText:"Reset",onOk:async()=>{try{await z(),x.success("Settings reset to defaults")}catch(h){console.error("Reset defaults error:",h),x.error("Failed to reset settings")}}})};return e.jsxs(C,{orientation:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs(K,{children:[e.jsx(G,{level:2,children:"Settings"}),e.jsx(J,{children:"Configure your data analyzer preferences and manage storage."})]}),e.jsx(K,{title:e.jsxs(C,{children:[e.jsx(Ct,{}),"Appearance"]}),children:e.jsx(C,{orientation:"vertical",size:"middle",style:{width:"100%"},children:e.jsxs("div",{children:[e.jsx(G,{level:4,children:"Theme"}),e.jsx(J,{type:"secondary",children:"Choose your preferred color theme. Your selection will be saved and applied automatically."}),e.jsxs(ie.Group,{value:t,onChange:h=>{i(),x.success(`Switched to ${h.target.value} mode`)},buttonStyle:"solid",children:[e.jsx(ie.Button,{value:"light",children:"Light"}),e.jsx(ie.Button,{value:"dark",children:"Dark"})]})]})})}),e.jsx(bt,{}),e.jsx(K,{title:e.jsxs(C,{children:[e.jsx(Xe,{}),"Storage Management"]}),extra:e.jsx(T,{icon:e.jsx(xe,{}),onClick:o,loading:g,size:"small",children:"Refresh"}),children:e.jsxs(C,{orientation:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(G,{level:4,children:"Storage Statistics"}),e.jsxs(Y,{gutter:[16,16],children:[e.jsx(R,{xs:24,sm:12,md:6,children:e.jsx(M,{title:"Total Size",value:a?H(a.total):"0 B",loading:g})}),e.jsx(R,{xs:24,sm:12,md:6,children:e.jsx(M,{title:`Files (${(a==null?void 0:a.counts.files)||0})`,value:a?H(a.files):"0 B",loading:g})}),e.jsx(R,{xs:24,sm:12,md:6,children:e.jsx(M,{title:`Python Code (${(a==null?void 0:a.counts.pythonScripts)||0})`,value:a?H(a.pythonCode):"0 B",loading:g})}),e.jsx(R,{xs:24,sm:12,md:6,children:e.jsx(M,{title:`Python Results (${(a==null?void 0:a.counts.pythonResults)||0})`,value:a?H(a.executionResults):"0 B",loading:g})}),e.jsx(R,{xs:24,sm:12,md:6,children:e.jsx(M,{title:`SQL Scripts (${(a==null?void 0:a.counts.sqlScripts)||0})`,value:a?H(a.sqlQueries):"0 B",loading:g})}),e.jsx(R,{xs:24,sm:12,md:6,children:e.jsx(M,{title:`SQL Results (${(a==null?void 0:a.counts.sqlResults)||0})`,value:a?H(a.sqlQueryResults):"0 B",loading:g})})]}),a&&a.fileDetails.length>0&&e.jsx("div",{style:{marginTop:24},children:e.jsxs(C,{orientation:"vertical",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(k,{strong:!0,children:"File Breakdown"}),e.jsx(T,{size:"small",icon:e.jsx(Ve,{}),onClick:()=>n("/files"),children:"View All Files"})]}),e.jsx("div",{children:e.jsx(C,{size:[8,8],wrap:!0,children:Object.entries(a.fileTypeCounts).map(([h,q])=>e.jsxs(ye,{color:h==="csv"?"green":h==="json"?"blue":h==="xlsx"?"orange":"purple",children:[q," ",h.toUpperCase()]},h))})}),a.fileDetails.length>0&&e.jsxs("div",{children:[e.jsx(k,{type:"secondary",children:"Top Files by Size:"}),e.jsx("ul",{style:{marginTop:8,paddingLeft:20},children:a.fileDetails.slice(0,5).map(h=>e.jsxs("li",{children:[e.jsx(k,{children:h.name}),e.jsxs(k,{type:"secondary",children:[" - ",H(h.size)]})]},h.id))})]})]})})]}),e.jsx(ce,{}),e.jsxs("div",{children:[e.jsx(G,{level:4,children:"Clear Data"}),e.jsx(Se,{message:"Warning",description:"Clear operations are permanent and cannot be undone. Make sure to export any important data before clearing.",type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsxs(C,{orientation:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(k,{strong:!0,children:"Python Data"}),e.jsx("div",{style:{marginTop:8},children:e.jsxs(C,{wrap:!0,children:[e.jsx(T,{icon:e.jsx(W,{}),onClick:F,danger:!0,children:"Clear Python Code"}),e.jsx(T,{icon:e.jsx(W,{}),onClick:O,danger:!0,children:"Clear Python Results"})]})})]}),e.jsxs("div",{children:[e.jsx(k,{strong:!0,children:"SQL Data"}),e.jsx("div",{style:{marginTop:8},children:e.jsxs(C,{wrap:!0,children:[e.jsx(T,{icon:e.jsx(W,{}),onClick:w,danger:!0,children:"Clear SQL Scripts"}),e.jsx(T,{icon:e.jsx(W,{}),onClick:E,danger:!0,children:"Clear SQL Results"}),e.jsx(T,{icon:e.jsx(W,{}),onClick:b,danger:!0,children:"Clear All SQL Data"})]})})]}),e.jsxs("div",{children:[e.jsx(k,{strong:!0,children:"All Data"}),e.jsx("div",{style:{marginTop:8},children:e.jsxs(C,{wrap:!0,children:[e.jsx(T,{icon:e.jsx(W,{}),onClick:N,danger:!0,children:"Clear Files"}),e.jsx(T,{icon:e.jsx(W,{}),onClick:X,danger:!0,type:"primary",children:"Clear Everything"})]})})]})]})]})]})}),e.jsx(K,{title:"Python Package Settings",extra:e.jsx(T,{icon:e.jsx(xe,{}),onClick:$,size:"small",children:"Reset to Defaults"}),children:e.jsxs(C,{orientation:"vertical",size:"large",style:{width:"100%"},children:[e.jsx("div",{children:e.jsxs(C,{align:"start",children:[e.jsx(Re,{checked:(u==null?void 0:u.autoDetect)??!0,onChange:_,loading:s,checkedChildren:e.jsx(Ge,{})}),e.jsxs("div",{children:[e.jsx(k,{strong:!0,children:"Auto-detect packages from imports"}),e.jsx("br",{}),e.jsx(k,{type:"secondary",children:"When enabled, Pyodide will automatically load packages based on import statements in your code. This is the recommended setting for most users."})]})]})}),e.jsx(ce,{}),e.jsxs("div",{children:[e.jsx(G,{level:4,children:"Pre-load Packages"}),e.jsx(J,{type:"secondary",children:"Select Python packages to pre-load when Pyodide initializes. These packages will be available immediately without needing to wait for auto-detection."}),e.jsx(fe,{mode:"multiple",style:{width:"100%"},placeholder:"Select packages to pre-load",value:(u==null?void 0:u.packages)??[],onChange:B,loading:s,disabled:s,children:kt.map(h=>e.jsx(fe.Option,{value:h,children:h},h))}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx(k,{type:"secondary",children:"Currently selected: "}),((u==null?void 0:u.packages)??[]).length>0?u==null?void 0:u.packages.map(h=>e.jsx(ye,{color:"blue",children:h},h)):e.jsx(k,{type:"secondary",children:"None"})]})]}),e.jsx(ce,{}),e.jsx(Se,{message:"Package Information",description:e.jsxs("div",{children:[e.jsx(J,{children:"Available packages: pandas, numpy, matplotlib, scipy, scikit-learn, statsmodels, seaborn"}),e.jsx(J,{children:"Note: Package loading happens in the Web Worker and may take a few seconds on first use. Auto-detection analyzes your import statements and loads packages dynamically."})]}),type:"info",showIcon:!0})]})})]})},At=d.memo(Tt);export{At as default};
