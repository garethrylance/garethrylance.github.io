var Ct=Object.defineProperty;var $t=(t,e,s)=>e in t?Ct(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var pe=(t,e,s)=>$t(t,typeof e!="symbol"?e+"":e,s);import{g as Pe,m as Ue,O as bt,e as Xe,P as Et,Q as vt,U as jt,V as Tt,r as a,a as q,W as ge,f as Ie,X as Rt,d as Be,Y as Ye,Z as Je,T as $e,$ as zt,a0 as Ke,a1 as kt,b as A,a2 as Pt,a3 as D,a4 as It,z as Qe,a5 as be,a6 as Ze,a7 as Bt,a8 as Nt,B as H,a9 as Dt,o as qt,I as ye,k as xe,n as r,S as z,aa as ze,s as me,l as Mt,q as Ft,ab as et,w as Qt}from"./index-BFFdXZpM.js";import{m as Lt,u as At,r as Le,D as Ot,A as Wt,P as Ht,d as $,s as v,C as Z,E as he,M as Ce,S as _t,f as Vt,T as Ee,a as Gt}from"./fileValidation-DIdSJVV_.js";import{P as Ut,v as tt,a as Xt,R as Ae,I as Te,u as Yt,C as Jt}from"./index-BgvQ2nqi.js";import{A as st,R as rt}from"./DeleteOutlined-CK9D6h98.js";import{R as ke,a as Ne,F as Kt,c as Zt,b as es,T as ts}from"./TableView-ClT9M1bC.js";import{R as ss,a as Oe,b as rs}from"./FileOutlined-7NO9Px39.js";import{C as ns,R as as,a as nt}from"./row-2CVu-iqR.js";import{R as is}from"./ReloadOutlined-DBoLKkoB.js";const ue=t=>t?typeof t=="function"?t():t:null,ls=t=>{const{componentCls:e,popoverColor:s,titleMinWidth:i,fontWeightStrong:l,innerPadding:n,boxShadowSecondary:g,colorTextHeading:c,borderRadiusLG:u,zIndexPopup:h,titleMarginBottom:m,colorBgElevated:x,popoverBg:w,titleBorderBottom:C,innerContentPadding:S,titlePadding:f}=t;return[{[e]:{...Xe(t),position:"absolute",top:0,left:{_skip_check_:!0,value:0},zIndex:h,fontWeight:"normal",whiteSpace:"normal",textAlign:"start",cursor:"auto",userSelect:"text","--valid-offset-x":"var(--arrow-offset-horizontal, var(--arrow-x))",transformOrigin:["var(--valid-offset-x, 50%)","var(--arrow-y, 50%)"].join(" "),"--antd-arrow-background-color":x,width:"max-content",maxWidth:"100vw","&-rtl":{direction:"rtl"},"&-hidden":{display:"none"},[`${e}-content`]:{position:"relative"},[`${e}-container`]:{backgroundColor:w,backgroundClip:"padding-box",borderRadius:u,boxShadow:g,padding:n},[`${e}-title`]:{minWidth:i,marginBottom:m,color:c,fontWeight:l,borderBottom:C,padding:f},[`${e}-content`]:{color:s,padding:S}}},Et(t,"var(--antd-arrow-background-color)"),{[`${e}-pure`]:{position:"relative",maxWidth:"none",margin:t.sizePopupArrow,display:"inline-block"}}]},os=t=>{const{componentCls:e}=t;return{[e]:vt.map(s=>{const i=t[`${s}6`];return{[`&${e}-${s}`]:{"--antd-arrow-background-color":i,[`${e}-inner`]:{backgroundColor:i},[`${e}-arrow`]:{background:"transparent"}}}})}},cs=t=>{const{lineWidth:e,controlHeight:s,fontHeight:i,padding:l,wireframe:n,zIndexPopupBase:g,borderRadiusLG:c,marginXS:u,lineType:h,colorSplit:m,paddingSM:x}=t,w=s-i,C=w/2,S=w/2-e,f=l;return{titleMinWidth:177,zIndexPopup:g+30,...Tt(t),...jt({contentRadius:c,limitVerticalRadius:!0}),innerPadding:n?0:12,titleMarginBottom:n?0:u,titlePadding:n?`${C}px ${f}px ${S}px`:0,titleBorderBottom:n?`${e}px ${h} ${m}`:"none",innerContentPadding:n?`${x}px ${f}px`:0}},at=Pe("Popover",t=>{const{colorBgElevated:e,colorText:s}=t,i=Ue(t,{popoverBg:e,popoverColor:s});return[ls(i),os(i),bt(i,"zoom-big")]},cs,{resetStyle:!1,deprecatedTokens:[["width","titleMinWidth"],["minWidth","titleMinWidth"]]}),it=t=>{const{title:e,content:s,prefixCls:i,classNames:l,styles:n}=t;return!e&&!s?null:a.createElement(a.Fragment,null,e&&a.createElement("div",{className:q(`${i}-title`,l==null?void 0:l.title),style:n==null?void 0:n.title},e),s&&a.createElement("div",{className:q(`${i}-content`,l==null?void 0:l.content),style:n==null?void 0:n.content},s))},ds=t=>{const{hashId:e,prefixCls:s,className:i,style:l,placement:n="top",title:g,content:c,children:u,classNames:h,styles:m}=t,x=ue(g),w=ue(c),C={...t,placement:n},[S,f]=Ie([h],[m],{props:C}),p=q(e,s,`${s}-pure`,`${s}-placement-${n}`,i);return a.createElement("div",{className:p,style:l},a.createElement("div",{className:`${s}-arrow`}),a.createElement(Rt,{...t,className:e,prefixCls:s,classNames:S,styles:f},u||a.createElement(it,{prefixCls:s,title:x,content:w,classNames:S,styles:f})))},lt=t=>{const{prefixCls:e,className:s,...i}=t,{getPrefixCls:l}=a.useContext(ge),n=l("popover",e),[g,c]=at(n);return a.createElement(ds,{...i,prefixCls:n,hashId:g,className:q(s,c)})},us=a.forwardRef((t,e)=>{const{prefixCls:s,title:i,content:l,overlayClassName:n,placement:g="top",trigger:c,children:u,mouseEnterDelay:h=.1,mouseLeaveDelay:m=.1,onOpenChange:x,overlayStyle:w={},styles:C,classNames:S,motion:f,arrow:p,...o}=t,{getPrefixCls:d,className:y,style:b,classNames:P,styles:M,arrow:j,trigger:T}=Be("popover"),I=d("popover",s),[ee,ne]=at(I),ae=d(),te=Ye(p,j),se=c||T||"hover",O={...t,placement:g,trigger:se,mouseEnterDelay:h,mouseLeaveDelay:m,overlayStyle:w,styles:C,classNames:S},[V,Q]=Ie([P,S],[M,C],{props:O}),G=q(n,ee,ne,y,V.root),[B,R]=Je(t.defaultOpen??!1,t.open),N=(L,ce)=>{R(L),x==null||x(L,ce)},E=L=>{L.keyCode===kt.ESC&&N(!1,L)},U=L=>{N(L)},X=ue(i),Y=ue(l);return a.createElement($e,{unique:!1,arrow:te,placement:g,trigger:se,mouseEnterDelay:h,mouseLeaveDelay:m,...o,prefixCls:I,classNames:{root:G,container:V.container,arrow:V.arrow},styles:{root:{...Q.root,...b,...w},container:Q.container,arrow:Q.arrow},ref:e,open:B,onOpenChange:U,overlay:X||Y?a.createElement(it,{prefixCls:I,title:X,content:Y,classNames:V,styles:Q}):null,motion:{motionName:zt(ae,"zoom-big",typeof(f==null?void 0:f.motionName)=="string"?f==null?void 0:f.motionName:void 0)},"data-popover-inject":!0},Ke(u,{onKeyDown:L=>{var ce,ie;a.isValidElement(u)&&((ie=u==null?void 0:(ce=u.props).onKeyDown)==null||ie.call(ce,L)),E(L)}}))}),ot=us;ot._InternalPanelDoNotUseOrYouWillBeFired=lt;var gs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"},ms={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"},ps={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"},fs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M848 359.3H627.7L825.8 109c4.1-5.3.4-13-6.3-13H436c-2.8 0-5.5 1.5-6.9 4L170 547.5c-3.1 5.3.7 12 6.9 12h174.4l-89.4 357.6c-1.9 7.8 7.5 13.3 13.3 7.7L853.5 373c5.2-4.9 1.7-13.7-5.5-13.7zM378.2 732.5l60.3-241H281.1l189.6-327.4h224.6L487 427.4h211L378.2 732.5z"}}]},name:"thunderbolt",theme:"outlined"};const De=A.createContext({});De.Consumer;const hs=({prefixCls:t,className:e,avatar:s,title:i,description:l,...n})=>{const{getPrefixCls:g}=a.useContext(ge),c=g("list",t),u=q(`${c}-item-meta`,e),h=A.createElement("div",{className:`${c}-item-meta-content`},i&&A.createElement("h4",{className:`${c}-item-meta-title`},i),l&&A.createElement("div",{className:`${c}-item-meta-description`},l));return A.createElement("div",{...n,className:u},s&&A.createElement("div",{className:`${c}-item-meta-avatar`},s),(i||l)&&h)},ys=A.forwardRef((t,e)=>{const{prefixCls:s,children:i,actions:l,extra:n,styles:g,className:c,classNames:u,colStyle:h,...m}=t,{grid:x,itemLayout:w}=a.useContext(De),{getPrefixCls:C,list:S}=a.useContext(ge),f=j=>{var T,I;return q((I=(T=S==null?void 0:S.item)==null?void 0:T.classNames)==null?void 0:I[j],u==null?void 0:u[j])},p=j=>{var T,I;return{...(I=(T=S==null?void 0:S.item)==null?void 0:T.styles)==null?void 0:I[j],...g==null?void 0:g[j]}},o=()=>{const j=Pt(i);return j.some(I=>typeof I=="string")&&j.length>1},d=()=>w==="vertical"?!!n:!o(),y=C("list",s),b=l&&l.length>0&&A.createElement("ul",{className:q(`${y}-item-action`,f("actions")),key:"actions",style:p("actions")},l.map((j,T)=>A.createElement("li",{key:`${y}-item-action-${T}`},j,T!==l.length-1&&A.createElement("em",{className:`${y}-item-action-split`})))),P=x?"div":"li",M=A.createElement(P,{...m,...x?{}:{ref:e},className:q(`${y}-item`,{[`${y}-item-no-flex`]:!d()},c)},w==="vertical"&&n?[A.createElement("div",{className:`${y}-item-main`,key:"content"},i,b),A.createElement("div",{className:q(`${y}-item-extra`,f("extra")),key:"extra",style:p("extra")},n)]:[i,b,Ke(n,{key:"extra"})]);return x?A.createElement(ns,{ref:e,flex:1,style:h},M):M}),ct=ys;ct.Meta=hs;const xs=t=>{const{listBorderedCls:e,componentCls:s,paddingLG:i,margin:l,itemPaddingSM:n,itemPaddingLG:g,marginLG:c,borderRadiusLG:u}=t,h=D(t.calc(u).sub(t.lineWidth).equal());return{[e]:{border:`${D(t.lineWidth)} ${t.lineType} ${t.colorBorder}`,borderRadius:u,[`${s}-header`]:{borderRadius:`${h} ${h} 0 0`},[`${s}-footer`]:{borderRadius:`0 0 ${h} ${h}`},[`${s}-header,${s}-footer,${s}-item`]:{paddingInline:i},[`${s}-pagination`]:{margin:`${D(l)} ${D(c)}`}},[`${e}${s}-sm`]:{[`${s}-item,${s}-header,${s}-footer`]:{padding:n}},[`${e}${s}-lg`]:{[`${s}-item,${s}-header,${s}-footer`]:{padding:g}}}},ws=t=>{const{componentCls:e,screenSM:s,screenMD:i,marginLG:l,marginSM:n,margin:g}=t;return{[`@media screen and (max-width:${i}px)`]:{[e]:{[`${e}-item`]:{[`${e}-item-action`]:{marginInlineStart:l}}},[`${e}-vertical`]:{[`${e}-item`]:{[`${e}-item-extra`]:{marginInlineStart:l}}}},[`@media screen and (max-width: ${s}px)`]:{[e]:{[`${e}-item`]:{flexWrap:"wrap",[`${e}-action`]:{marginInlineStart:n}}},[`${e}-vertical`]:{[`${e}-item`]:{flexWrap:"wrap-reverse",[`${e}-item-main`]:{minWidth:t.contentWidth},[`${e}-item-extra`]:{margin:`auto auto ${D(g)}`}}}}}},Ss=t=>{const{componentCls:e,antCls:s,controlHeight:i,minHeight:l,paddingSM:n,marginLG:g,padding:c,itemPadding:u,colorPrimary:h,itemPaddingSM:m,itemPaddingLG:x,paddingXS:w,margin:C,colorText:S,colorTextDescription:f,motionDurationSlow:p,lineWidth:o,headerBg:d,footerBg:y,emptyTextPadding:b,metaMarginBottom:P,avatarMarginRight:M,titleMarginBottom:j,descriptionFontSize:T}=t;return{[e]:{...Xe(t),position:"relative","--rc-virtual-list-scrollbar-bg":t.colorSplit,"*":{outline:"none"},[`${e}-header`]:{background:d},[`${e}-footer`]:{background:y},[`${e}-header, ${e}-footer`]:{paddingBlock:n},[`${e}-pagination`]:{marginBlockStart:g,[`${s}-pagination-options`]:{textAlign:"start"}},[`${e}-spin`]:{minHeight:l,textAlign:"center"},[`${e}-items`]:{margin:0,padding:0,listStyle:"none"},[`${e}-item`]:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:u,color:S,[`${e}-item-meta`]:{display:"flex",flex:1,alignItems:"flex-start",maxWidth:"100%",[`${e}-item-meta-avatar`]:{marginInlineEnd:M},[`${e}-item-meta-content`]:{flex:"1 0",width:0,color:S},[`${e}-item-meta-title`]:{margin:`0 0 ${D(t.marginXXS)} 0`,color:S,fontSize:t.fontSize,lineHeight:t.lineHeight,"> a":{color:S,transition:`all ${p}`,"&:hover":{color:h}}},[`${e}-item-meta-description`]:{color:f,fontSize:T,lineHeight:t.lineHeight}},[`${e}-item-action`]:{flex:"0 0 auto",marginInlineStart:t.marginXXL,padding:0,fontSize:0,listStyle:"none","& > li":{position:"relative",display:"inline-block",padding:`0 ${D(w)}`,color:f,fontSize:t.fontSize,lineHeight:t.lineHeight,textAlign:"center","&:first-child":{paddingInlineStart:0}},[`${e}-item-action-split`]:{position:"absolute",insetBlockStart:"50%",insetInlineEnd:0,width:o,height:t.calc(t.fontHeight).sub(t.calc(t.marginXXS).mul(2)).equal(),transform:"translateY(-50%)",backgroundColor:t.colorSplit}}},[`${e}-empty`]:{padding:`${D(c)} 0`,color:f,fontSize:t.fontSizeSM,textAlign:"center"},[`${e}-empty-text`]:{padding:b,color:t.colorTextDisabled,fontSize:t.fontSize,textAlign:"center"},[`${e}-item-no-flex`]:{display:"block"}},[`${e}-grid ${s}-col > ${e}-item`]:{display:"block",maxWidth:"100%",marginBlockEnd:C,paddingBlock:0,borderBlockEnd:"none"},[`${e}-vertical ${e}-item`]:{alignItems:"initial",[`${e}-item-main`]:{display:"block",flex:1},[`${e}-item-extra`]:{marginInlineStart:g},[`${e}-item-meta`]:{marginBlockEnd:P,[`${e}-item-meta-title`]:{marginBlockStart:0,marginBlockEnd:j,color:S,fontSize:t.fontSizeLG,lineHeight:t.lineHeightLG}},[`${e}-item-action`]:{marginBlockStart:c,marginInlineStart:"auto","> li":{padding:`0 ${D(c)}`,"&:first-child":{paddingInlineStart:0}}}},[`${e}-split ${e}-item`]:{borderBlockEnd:`${D(t.lineWidth)} ${t.lineType} ${t.colorSplit}`,"&:last-child":{borderBlockEnd:"none"}},[`${e}-split ${e}-header`]:{borderBlockEnd:`${D(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-split${e}-empty ${e}-footer`]:{borderTop:`${D(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-loading ${e}-spin-nested-loading`]:{minHeight:i},[`${e}-split${e}-something-after-last-item ${s}-spin-container > ${e}-items > ${e}-item:last-child`]:{borderBlockEnd:`${D(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-lg ${e}-item`]:{padding:x},[`${e}-sm ${e}-item`]:{padding:m},[`${e}:not(${e}-vertical)`]:{[`${e}-item-no-flex`]:{[`${e}-item-action`]:{float:"right"}}}}},Cs=t=>({contentWidth:220,itemPadding:`${D(t.paddingContentVertical)} 0`,itemPaddingSM:`${D(t.paddingContentVerticalSM)} ${D(t.paddingContentHorizontal)}`,itemPaddingLG:`${D(t.paddingContentVerticalLG)} ${D(t.paddingContentHorizontalLG)}`,headerBg:"transparent",footerBg:"transparent",emptyTextPadding:t.padding,metaMarginBottom:t.padding,avatarMarginRight:t.padding,titleMarginBottom:t.paddingSM,descriptionFontSize:t.fontSize}),$s=Pe("List",t=>{const e=Ue(t,{listBorderedCls:`${t.componentCls}-bordered`,minHeight:t.controlHeightLG});return[Ss(e),xs(e),ws(e)]},Cs),bs=(t,e)=>{const{pagination:s=!1,prefixCls:i,bordered:l=!1,split:n=!0,className:g,rootClassName:c,style:u,children:h,itemLayout:m,loadMore:x,grid:w,dataSource:C=[],size:S,header:f,footer:p,loading:o=!1,rowKey:d,renderItem:y,locale:b,...P}=t,M=s&&typeof s=="object"?s:{},[j,T]=a.useState(M.defaultCurrent||1),[I,ee]=a.useState(M.defaultPageSize||10),{getPrefixCls:ne,direction:ae,className:te,style:se}=Be("list"),{renderEmpty:O}=a.useContext(ge),V={current:1,total:0,position:"bottom"},Q=k=>(W,re)=>{var Fe;T(W),ee(re),s&&((Fe=s==null?void 0:s[k])==null||Fe.call(s,W,re))},G=Q("onChange"),B=Q("onShowSizeChange"),R=(k,W)=>{if(!y)return null;let re;return typeof d=="function"?re=d(k):d?re=k[d]:re=k.key,re||(re=`list-item-${W}`),a.createElement(a.Fragment,{key:re},y(k,W))},N=!!(x||s||p),E=ne("list",i),[U,X]=$s(E);let Y=o;typeof Y=="boolean"&&(Y={spinning:Y});const L=!!(Y!=null&&Y.spinning),ce=It(S);let ie="";switch(ce){case"large":ie="lg";break;case"small":ie="sm";break}const ht=q(E,{[`${E}-vertical`]:m==="vertical",[`${E}-${ie}`]:ie,[`${E}-split`]:n,[`${E}-bordered`]:l,[`${E}-loading`]:L,[`${E}-grid`]:!!w,[`${E}-something-after-last-item`]:N,[`${E}-rtl`]:ae==="rtl"},te,g,c,U,X),_=Lt(V,{total:C.length,current:j,pageSize:I},s||{}),yt=Math.ceil(_.total/_.pageSize);_.current=Math.min(_.current,yt);const qe=s&&a.createElement("div",{className:q(`${E}-pagination`)},a.createElement(Ut,{align:"end",..._,onChange:G,onShowSizeChange:B}));let ve=Qe(C);s&&C.length>(_.current-1)*_.pageSize&&(ve=Qe(C).splice((_.current-1)*_.pageSize,_.pageSize));const xt=Object.keys(w||{}).some(k=>["xs","sm","md","lg","xl","xxl"].includes(k)),Me=At(xt),we=a.useMemo(()=>{for(let k=0;k<Le.length;k+=1){const W=Le[k];if(Me[W])return W}},[Me]),wt=a.useMemo(()=>{if(!w)return;const k=we&&w[we]?w[we]:w.column;if(k)return{width:`${100/k}%`,maxWidth:`${100/k}%`}},[JSON.stringify(w),we]);let je=L&&a.createElement("div",{style:{minHeight:53}});if(ve.length>0){const k=ve.map(R);je=w?a.createElement(as,{gutter:w.gutter},a.Children.map(k,W=>a.createElement("div",{key:W==null?void 0:W.key,style:wt},W))):a.createElement("ul",{className:`${E}-items`},k)}else!h&&!L&&(je=a.createElement("div",{className:`${E}-empty-text`},(b==null?void 0:b.emptyText)||(O==null?void 0:O("List"))||a.createElement(Ot,{componentName:"List"})));const Se=_.position,St=a.useMemo(()=>({grid:w,itemLayout:m}),[JSON.stringify(w),m]);return a.createElement(De.Provider,{value:St},a.createElement("div",{ref:e,style:{...se,...u},className:ht,...P},(Se==="top"||Se==="both")&&qe,f&&a.createElement("div",{className:`${E}-header`},f),a.createElement(be,{...Y},je,h),p&&a.createElement("div",{className:`${E}-footer`},p),x||(Se==="bottom"||Se==="both")&&qe))},Es=a.forwardRef(bs),oe=Es;oe.Item=ct;const vs=t=>{const{componentCls:e,iconCls:s,antCls:i,zIndexPopup:l,colorText:n,colorWarning:g,marginXXS:c,marginXS:u,fontSize:h,fontWeightStrong:m,colorTextHeading:x}=t;return{[e]:{zIndex:l,[`&${i}-popover`]:{fontSize:h},[`${e}-message`]:{marginBottom:u,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${e}-message-icon ${s}`]:{color:g,fontSize:h,lineHeight:1,marginInlineEnd:u},[`${e}-title`]:{fontWeight:m,color:x,"&:only-child":{fontWeight:"normal"}},[`${e}-description`]:{marginTop:c,color:n}},[`${e}-buttons`]:{textAlign:"end",whiteSpace:"nowrap",button:{marginInlineStart:u}}}}},js=t=>{const{zIndexPopupBase:e}=t;return{zIndexPopup:e+60}},dt=Pe("Popconfirm",t=>vs(t),js,{resetStyle:!1}),ut=t=>{const{prefixCls:e,okButtonProps:s,cancelButtonProps:i,title:l,description:n,cancelText:g,okText:c,okType:u="primary",icon:h=a.createElement(Ze,null),showCancel:m=!0,close:x,onConfirm:w,onCancel:C,onPopupClick:S,classNames:f,styles:p}=t,{getPrefixCls:o}=a.useContext(ge),[d]=Bt("Popconfirm",Nt.Popconfirm),y=ue(l),b=ue(n);return a.createElement("div",{className:`${e}-inner-content`,onClick:S},a.createElement("div",{className:`${e}-message`},h&&a.createElement("span",{className:`${e}-message-icon`},h),a.createElement("div",{className:`${e}-message-text`},y&&a.createElement("div",{className:q(`${e}-title`,f==null?void 0:f.title),style:p==null?void 0:p.title},y),b&&a.createElement("div",{className:q(`${e}-description`,f==null?void 0:f.content),style:p==null?void 0:p.content},b))),a.createElement("div",{className:`${e}-buttons`},m&&a.createElement(H,{onClick:C,size:"small",...i},g||(d==null?void 0:d.cancelText)),a.createElement(Wt,{buttonProps:{size:"small",...Dt(u),...s},actionFn:w,close:x,prefixCls:o("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},c||(d==null?void 0:d.okText))))},Ts=t=>{const{prefixCls:e,placement:s,className:i,style:l,...n}=t,{getPrefixCls:g}=a.useContext(ge),c=g("popconfirm",e);return dt(c),a.createElement(lt,{placement:s,className:q(c,i),style:l,content:a.createElement(ut,{prefixCls:c,...n})})},Rs=a.forwardRef((t,e)=>{const{prefixCls:s,placement:i="top",trigger:l,okType:n="primary",icon:g=a.createElement(Ze,null),children:c,overlayClassName:u,onOpenChange:h,overlayStyle:m,styles:x,arrow:w,classNames:C,...S}=t,{getPrefixCls:f,className:p,style:o,classNames:d,styles:y,arrow:b,trigger:P}=Be("popconfirm"),[M,j]=Je(t.defaultOpen??!1,t.open),T=Ye(w,b),I=l||P||"click",ee=(R,N)=>{j(R),h==null||h(R,N)},ne=R=>{ee(!1,R)},ae=R=>{var N;return(N=t.onConfirm)==null?void 0:N.call(void 0,R)},te=R=>{var N;ee(!1,R),(N=t.onCancel)==null||N.call(void 0,R)},se=(R,N)=>{const{disabled:E=!1}=t;E||ee(R,N)},O=f("popconfirm",s),V={...t,placement:i,trigger:I,okType:n,overlayStyle:m,styles:x,classNames:C},[Q,G]=Ie([d,C],[y,x],{props:V}),B=q(O,p,u,Q.root);return dt(O),a.createElement(ot,{arrow:T,...qt(S,["title"]),trigger:I,placement:i,onOpenChange:se,open:M,ref:e,classNames:{root:B,container:Q.container,arrow:Q.arrow},styles:{root:{...o,...G.root,...m},container:G.container,arrow:G.arrow},content:a.createElement(ut,{okType:n,icon:g,...t,prefixCls:O,close:ne,onConfirm:ae,onCancel:te,classNames:Q,styles:G}),"data-popover-inject":!0},c)}),gt=Rs;gt._InternalPanelDoNotUseOrYouWillBeFired=Ts;var zs=function(e,s){return a.createElement(ye,xe({},e,{ref:s,icon:gs}))},ks=a.forwardRef(zs),Ps=function(e,s){return a.createElement(ye,xe({},e,{ref:s,icon:ms}))},mt=a.forwardRef(Ps),Is=function(e,s){return a.createElement(ye,xe({},e,{ref:s,icon:ps}))},Bs=a.forwardRef(Is),Ns=function(e,s){return a.createElement(ye,xe({},e,{ref:s,icon:Ht}))},We=a.forwardRef(Ns),Ds=function(e,s){return a.createElement(ye,xe({},e,{ref:s,icon:fs}))},qs=a.forwardRef(Ds);class F{static async initialize(e){var s,i;if(this.status!=="ready"){if(this.status==="initializing")return new Promise((l,n)=>{const g=setInterval(()=>{this.status==="ready"?(clearInterval(g),l()):this.status==="error"&&(clearInterval(g),n(new Error("DuckDB initialization failed")))},100)});this.status="initializing",this.progressCallback=e||null;try{this.worker=new Worker(new URL(""+new URL("duckdb.worker-CEs9AVLp.js",import.meta.url).href,import.meta.url),{type:"module"}),this.worker.onmessage=n=>{this.handleWorkerMessage(n.data)},this.worker.onerror=n=>{console.error("DuckDB worker error:",n),this.status="error"};const l=this.sendMessage("init","initialized");(s=this.progressCallback)==null||s.call(this,"Initializing DuckDB..."),await l,this.status="ready",(i=this.progressCallback)==null||i.call(this,"DuckDB ready")}catch(l){throw this.status="error",new Error(`Failed to initialize DuckDB: ${l instanceof Error?l.message:String(l)}`)}}}static async registerParquetFile(e){var i,l;if(this.status!=="ready")throw new Error("DuckDB not initialized. Call initialize() first.");if(e.fileType!=="parquet")throw new Error("Only Parquet files can be registered");if(!(e.content instanceof ArrayBuffer))throw new Error("Parquet file content must be ArrayBuffer");const s=this.sanitizeTableName(e.name);(i=this.progressCallback)==null||i.call(this,`Registering ${s}...`);try{return await this.sendMessage("register","registered",{tableName:s,fileContent:e.content}),(l=this.progressCallback)==null||l.call(this,`Table ${s} registered`),s}catch(n){throw new Error(`Failed to register file: ${n instanceof Error?n.message:String(n)}`)}}static async registerFileForScript(e){var i,l;if(this.status!=="ready")throw new Error("DuckDB not initialized. Call initialize() first.");if(e.fileType!=="parquet")throw new Error("Only Parquet files can be registered");if(!(e.content instanceof ArrayBuffer))throw new Error("Parquet file content must be ArrayBuffer");const s=this.sanitizeTableName(e.name);(i=this.progressCallback)==null||i.call(this,`Registering ${s} for script...`);try{return await this.sendMessage("register","registered",{tableName:s,fileContent:e.content}),(l=this.progressCallback)==null||l.call(this,`Table ${s} registered`),s}catch(n){throw new Error(`Failed to register file: ${n instanceof Error?n.message:String(n)}`)}}static async unregisterScriptTables(e){var s;if(this.status!=="ready")throw new Error("DuckDB not initialized. Call initialize() first.");try{const l=(await this.listTables()).filter(n=>n.startsWith(`${e}_`));for(const n of l)await this.dropTable(n);(s=this.progressCallback)==null||s.call(this,`Unregistered ${l.length} tables for script`)}catch(i){throw new Error(`Failed to unregister script tables: ${i instanceof Error?i.message:String(i)}`)}}static getFriendlyTableName(e){const s=e.split("_");return s.length>1?s.slice(1).join("_"):e}static async executeQuery(e){var s,i;if(this.status!=="ready")throw new Error("DuckDB not initialized. Call initialize() first.");this.status="executing",(s=this.progressCallback)==null||s.call(this,"Executing query...");try{const l=await this.sendMessage("execute","result",{query:e});this.status="ready";const n=l.executionTime??0;return(i=this.progressCallback)==null||i.call(this,`Query completed in ${n.toFixed(2)}ms`),{data:l.data,executionTime:n}}catch(l){throw this.status="ready",new Error(`Query execution failed: ${l instanceof Error?l.message:String(l)}`)}}static async getTableSchema(e){if(this.status!=="ready")throw new Error("DuckDB not initialized. Call initialize() first.");try{return(await this.sendMessage("schema","schema",{tableName:e})).data}catch(s){throw new Error(`Failed to get schema: ${s instanceof Error?s.message:String(s)}`)}}static async listTables(){if(this.status!=="ready")throw new Error("DuckDB not initialized. Call initialize() first.");try{return(await this.sendMessage("list","list")).data.map(s=>s.name)}catch(e){throw new Error(`Failed to list tables: ${e instanceof Error?e.message:String(e)}`)}}static async dropTable(e){var s;if(this.status!=="ready")throw new Error("DuckDB not initialized. Call initialize() first.");try{await this.sendMessage("drop","dropped",{tableName:e}),(s=this.progressCallback)==null||s.call(this,`Table ${e} dropped`)}catch(i){throw new Error(`Failed to drop table: ${i instanceof Error?i.message:String(i)}`)}}static getStatus(){return this.status}static setProgressCallback(e){this.progressCallback=e}static terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.status="idle",this.messageHandlers.clear(),this.progressCallback=null)}static sendMessage(e,s,i){return new Promise((l,n)=>{const g=`${e}-${Date.now()}-${Math.random()}`;this.messageHandlers.set(g,c=>{c.type===s?(this.messageHandlers.delete(g),l({data:c.data,executionTime:c.executionTime})):c.type==="error"&&(this.messageHandlers.delete(g),n(new Error(c.error||"Unknown error")))}),this.worker.postMessage({type:e,payload:i}),setTimeout(()=>{this.messageHandlers.has(g)&&(this.messageHandlers.delete(g),n(new Error(`Message timeout: ${e}`)))},3e4)})}static handleWorkerMessage(e){var s;if(e.type==="progress"){(s=this.progressCallback)==null||s.call(this,e.message||"");return}e.type==="error"&&console.error("DuckDB worker error:",e.error),this.messageHandlers.forEach(i=>{i(e)})}static sanitizeTableName(e){return e.replace(/\.parquet$/i,"").replace(/[^a-zA-Z0-9_]/g,"_").replace(/^[0-9]/,"_$&").toLowerCase()}}pe(F,"worker",null),pe(F,"status","idle"),pe(F,"messageHandlers",new Map),pe(F,"progressCallback",null);function Ms(){const[t,e]=a.useState("idle"),[s,i]=a.useState([]),[l,n]=a.useState(null),[g,c]=a.useState(""),u=a.useCallback(async()=>{try{n(null);const o=await F.listTables();i(o)}catch(o){console.warn("Failed to list tables:",o)}},[]),h=a.useCallback(async()=>{try{n(null),e("initializing"),F.setProgressCallback(o=>{c(o)}),await F.initialize(o=>{c(o)}),e("ready"),c("DuckDB initialized successfully"),await u()}catch(o){const d=o instanceof Error?o.message:"Failed to initialize DuckDB";n(d),e("error"),c("")}},[u]),m=a.useCallback(async o=>{try{n(null);const d=await F.registerParquetFile(o);return await u(),d}catch(d){const y=d instanceof Error?d.message:"Failed to register file";throw n(y),d}},[u]),x=a.useCallback(async o=>{try{n(null);const d=await F.registerFileForScript(o);return await u(),d}catch(d){const y=d instanceof Error?d.message:"Failed to register file for script";throw n(y),d}},[u]),w=a.useCallback(async o=>{try{n(null),await F.unregisterScriptTables(o),await u()}catch(d){const y=d instanceof Error?d.message:"Failed to unregister script tables";throw n(y),d}},[u]),C=a.useCallback(async o=>{try{n(null),e("executing");const d=await F.executeQuery(o);return e("ready"),d}catch(d){const y=d instanceof Error?d.message:"Query execution failed";throw n(y),e("ready"),d}},[]),S=a.useCallback(async o=>{try{return n(null),await F.getTableSchema(o)}catch(d){const y=d instanceof Error?d.message:"Failed to get schema";throw n(y),d}},[]),f=a.useCallback(async o=>{try{n(null),await F.dropTable(o),await u()}catch(d){const y=d instanceof Error?d.message:"Failed to drop table";throw n(y),d}},[u]),p=a.useCallback(()=>{F.terminate(),e("idle"),i([]),n(null),c("")},[]);return a.useEffect(()=>{e(F.getStatus())},[]),{status:t,tables:s,error:l,progressMessage:g,initialize:h,registerFile:m,registerFileForScript:x,unregisterScriptTables:w,executeQuery:C,getSchema:S,listTables:u,dropTable:f,terminate:p}}class K{static async createScript(e){const s=e||`Script ${new Date().toLocaleString()}`,i={id:tt(),name:s,fileIds:[],registeredTables:[],query:this.getDefaultQuery([]),createdAt:new Date,updatedAt:new Date};return await $.sqlQueries.add(i),i}static async renameScript(e,s){await $.sqlQueries.update(e,{name:s,updatedAt:new Date});const i=await $.sqlQueries.get(e);if(!i)throw new Error("Failed to rename script");return i}static async saveQuery(e,s,i,l){await $.sqlQueries.update(e,{fileIds:s,registeredTables:i,query:l,updatedAt:new Date});const n=await $.sqlQueries.get(e);if(!n)throw new Error("Failed to update query");return n}static async getQuery(e){return $.sqlQueries.get(e)}static async getAllScripts(){return $.sqlQueries.orderBy("updatedAt").reverse().toArray()}static async getScriptByName(e){return $.sqlQueries.where("name").equals(e).first()}static async deleteQuery(e){await $.transaction("rw",[$.sqlQueries,$.sqlQueryResults],async()=>{await $.sqlQueries.delete(e),await $.sqlQueryResults.where("queryId").equals(e).delete()})}static async updateRegisteredTables(e,s){await $.sqlQueries.update(e,{registeredTables:s,updatedAt:new Date})}static async updateFileIds(e,s){await $.sqlQueries.update(e,{fileIds:s,updatedAt:new Date})}static getDefaultQuery(e){return e.length===0?`-- Select one or more Parquet files to start querying
`:e.length===1?`-- Query ${e[0]}
SELECT * FROM ${e[0]} LIMIT 100;`:`-- Query multiple tables with JOIN
SELECT *
FROM ${e[0]} t1
JOIN ${e[1]} t2 ON t1.id = t2.id
LIMIT 100;`}}const Fs=2e3;function Qs(t,e=[]){const[s,i]=a.useState(""),[l,n]=a.useState(!1),[g,c]=a.useState(!1),[u,h]=a.useState(null),m=a.useRef(null),x=a.useRef(""),w=a.useRef(null);a.useEffect(()=>{w.current=t},[t]),a.useEffect(()=>{t?(i(t.query),x.current=t.query,n(!1)):(i(K.getDefaultQuery([])),x.current="",n(!1))},[t]);const C=a.useCallback(async o=>{const d=w.current;if(d)try{c(!0),h(null),await K.saveQuery(d.id,d.fileIds,d.registeredTables,o),x.current=o,n(!1)}catch(y){const b=y instanceof Error?y.message:"Failed to save query";h(b)}finally{c(!1)}},[]),S=a.useCallback(o=>{i(o),n(o!==x.current),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{C(o)},Fs)},[C]),f=a.useCallback(async()=>{m.current&&(clearTimeout(m.current),m.current=null),await C(s)},[s,C]),p=a.useCallback(()=>{const o=K.getDefaultQuery(e);i(o),x.current="",n(!0)},[e]);return a.useEffect(()=>()=>{m.current&&clearTimeout(m.current)},[]),{query:s,isDirty:l,isSaving:g,error:u,updateQuery:S,saveQuery:f,resetQuery:p}}function Ls(){const t=Xt(()=>K.getAllScripts())??[],[e,s]=a.useState(null),[i,l]=a.useState(!1),n=a.useCallback(async h=>{l(!0);try{const m=await K.createScript(h);return s(m),v.success(`Created script: ${m.name}`),m}catch(m){throw v.error("Failed to create script"),console.error("Failed to create script:",m),m}finally{l(!1)}},[]),g=a.useCallback(async h=>{l(!0);try{const m=await K.getQuery(h);m?s(m):v.error("Script not found")}catch(m){v.error("Failed to load script"),console.error("Failed to load script:",m)}finally{l(!1)}},[]),c=a.useCallback(async(h,m)=>{l(!0);try{const x=await K.renameScript(h,m);(e==null?void 0:e.id)===h&&s(x),v.success("Script renamed successfully")}catch(x){v.error("Failed to rename script"),console.error("Failed to rename script:",x)}finally{l(!1)}},[e]),u=a.useCallback(async h=>{l(!0);try{await K.deleteQuery(h),(e==null?void 0:e.id)===h&&s(null),v.success("Script deleted successfully")}catch(m){v.error("Failed to delete script"),console.error("Failed to delete script:",m)}finally{l(!1)}},[e]);return a.useEffect(()=>{!e&&t.length>0&&s(t[0])},[t,e]),{scripts:t,currentScript:e,loading:i,createScript:n,selectScript:g,renameScript:c,deleteScript:u}}const He=10;class fe{static async saveResult(e,s,i,l,n,g){const c={id:tt(),queryId:e,querySnapshot:s,result:i,executionTime:l,status:n,errorMessage:g,executedAt:new Date};return await $.transaction("rw",$.sqlQueryResults,async()=>{await $.sqlQueryResults.add(c);const u=await $.sqlQueryResults.where("queryId").equals(e).reverse().sortBy("executedAt");if(u.length>He){const h=u.slice(He);for(const m of h)await $.sqlQueryResults.delete(m.id)}}),c}static async getResult(e){return $.sqlQueryResults.get(e)}static async getResultsByQuery(e){return $.sqlQueryResults.where("queryId").equals(e).reverse().sortBy("executedAt")}static async getMostRecentResult(e){return(await $.sqlQueryResults.where("queryId").equals(e).reverse().sortBy("executedAt"))[0]}static async getAllResults(){return $.sqlQueryResults.orderBy("executedAt").reverse().toArray()}static async deleteResult(e){await $.sqlQueryResults.delete(e)}static async deleteResultsForQuery(e){await $.sqlQueryResults.where("queryId").equals(e).delete()}static async getResultCount(e){return $.sqlQueryResults.where("queryId").equals(e).count()}static async getSuccessfulExecutionCount(e){return(await this.getResultsByQuery(e)).filter(i=>i.status==="success").length}static async getAverageExecutionTime(e){const i=(await this.getResultsByQuery(e)).filter(n=>n.status==="success");return i.length===0?0:i.reduce((n,g)=>n+g.executionTime,0)/i.length}static async getResultStats(e){const s=await this.getResultsByQuery(e),i=s.filter(n=>n.status==="success"),l=i.reduce((n,g)=>n+g.executionTime,0);return{count:s.length,successCount:i.length,avgExecutionTime:i.length>0?l/i.length:0}}}function As(){const[t,e]=a.useState([]),[s,i]=a.useState(null),[l,n]=a.useState(!1),[g,c]=a.useState(null),u=a.useCallback(async f=>{try{n(!0),c(null);const p=await fe.getResultsByQuery(f);e(p),p.length>0?i(p[0]):i(null)}catch(p){const o=p instanceof Error?p.message:"Failed to load results";c(o)}finally{n(!1)}},[]),h=a.useCallback(f=>{const p=t.find(o=>o.id===f);p&&i(p)},[t]),m=a.useCallback(()=>{t.length>0&&i(t[0])},[t]),x=a.useCallback(async(f,p,o,d,y,b)=>{try{c(null);const P=await fe.saveResult(f,p,o,d,y,b);return await u(f),i(P),P}catch(P){const M=P instanceof Error?P.message:"Failed to save result";throw c(M),P}},[u]),w=a.useCallback(async f=>{try{c(null),await fe.deleteResult(f),e(p=>p.filter(o=>o.id!==f)),(s==null?void 0:s.id)===f&&i(null)}catch(p){const o=p instanceof Error?p.message:"Failed to delete result";throw c(o),p}},[s]),C=a.useCallback(async f=>{try{c(null),await fe.deleteResultsForQuery(f),e([]),i(null)}catch(p){const o=p instanceof Error?p.message:"Failed to clear results";throw c(o),p}},[]),S=a.useCallback(async f=>{try{c(null);const p=await fe.getResultStats(f);return{count:p.count,successCount:p.successCount,avgTime:p.avgExecutionTime}}catch(p){const o=p instanceof Error?p.message:"Failed to get result stats";throw c(o),p}},[]);return{results:t,selectedResult:s,isLoading:l,error:g,loadResults:u,selectResult:h,selectMostRecent:m,saveResult:x,deleteResult:w,clearResults:C,getResultStats:S}}const Os=({status:t,message:e,tableCount:s=0})=>{const i=()=>{if(e)return e;switch(t){case"idle":return"DuckDB not initialized";case"initializing":return"Initializing DuckDB...";case"ready":return`DuckDB ready${s>0?` (${s} ${s===1?"table":"tables"} registered)`:""}`;case"executing":return"Executing query...";case"error":return"DuckDB error";default:return"Unknown status"}},l=()=>{switch(t){case"idle":return r.jsx(Bs,{});case"initializing":return r.jsx(be,{indicator:r.jsx(ke,{spin:!0})});case"ready":return r.jsx(Ne,{});case"executing":return r.jsx(be,{indicator:r.jsx(ke,{spin:!0})});case"error":return r.jsx(mt,{});default:return null}},n=()=>{switch(t){case"idle":return"info";case"initializing":return"info";case"ready":return"success";case"executing":return"info";case"error":return"error";default:return"info"}};return r.jsx(st,{message:i(),type:n(),icon:l(),showIcon:!0,style:{marginBottom:16}})},{Title:_e,Text:Ve}=me,Ws=({status:t,progressMessage:e,children:s})=>t==="ready"||t==="executing"?r.jsx(r.Fragment,{children:s}):t==="idle"||t==="initializing"?r.jsx(Z,{children:r.jsxs(z,{direction:"vertical",size:"large",style:{width:"100%",textAlign:"center"},children:[r.jsx(be,{indicator:r.jsx(ke,{style:{fontSize:48},spin:!0}),tip:e||"Initializing DuckDB...",children:r.jsx("div",{style:{padding:50},children:r.jsx(ze,{style:{fontSize:64,color:"#1890ff",opacity:.3}})})}),r.jsxs("div",{children:[r.jsx(_e,{level:4,children:"Setting up SQL Engine"}),r.jsx(Ve,{type:"secondary",children:e||"Please wait while DuckDB initializes..."})]})]})}):t==="error"?r.jsx(Z,{children:r.jsxs(z,{direction:"vertical",size:"large",style:{width:"100%",textAlign:"center"},children:[r.jsx(ze,{style:{fontSize:64,color:"#ff4d4f"}}),r.jsxs("div",{children:[r.jsx(_e,{level:4,children:"Failed to Initialize DuckDB"}),r.jsx(Ve,{type:"danger",children:e||"An error occurred while initializing the SQL engine."})]})]})}):null,{Text:J}=me,pt=a.memo(({scripts:t,currentScript:e,loading:s,onSelectScript:i,onCreateScript:l,onRenameScript:n,onDeleteScript:g})=>{const[c,u]=a.useState(!1),[h,m]=a.useState(!1),[x,w]=a.useState(""),[C,S]=a.useState(""),f=()=>{l(x||void 0),w(""),u(!1)},p=()=>{e&&C.trim()&&(n(e.id,C),S(""),m(!1))},o=()=>{e&&Ce.confirm({title:"Delete Script",content:`Are you sure you want to delete "${e.name}"? This will also delete all query results for this script.`,okText:"Delete",okType:"danger",onOk:()=>{g(e.id)}})},d=()=>{S((e==null?void 0:e.name)||""),m(!0)};return t.length===0?r.jsxs(Z,{children:[r.jsx(he,{image:r.jsx(Ae,{style:{fontSize:48,color:"#bfbfbf"}}),description:r.jsxs(z,{orientation:"vertical",size:"small",children:[r.jsx(J,{children:"No SQL scripts yet"}),r.jsx(J,{type:"secondary",style:{fontSize:12},children:"Create your first script to start querying Parquet files with SQL"})]}),children:r.jsx(H,{type:"primary",icon:r.jsx(We,{}),onClick:()=>u(!0),loading:s,children:"Create First Script"})}),r.jsx(Ce,{title:"Create New Script",open:c,onOk:f,onCancel:()=>u(!1),okText:"Create",children:r.jsxs(z,{orientation:"vertical",style:{width:"100%"},children:[r.jsx(J,{children:"Script Name (optional)"}),r.jsx(Te,{placeholder:"e.g., Sales Analysis Q4",value:x,onChange:y=>w(y.target.value),onPressEnter:f,autoFocus:!0}),r.jsx(J,{type:"secondary",style:{fontSize:12},children:"Leave empty for auto-generated name"})]})})]}):r.jsxs(Z,{children:[r.jsxs(z,{orientation:"vertical",size:"middle",style:{width:"100%"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs(z,{children:[r.jsx(Ae,{style:{fontSize:16}}),r.jsx(J,{strong:!0,children:"SQL Scripts"}),r.jsxs(J,{type:"secondary",children:["(",t.length,")"]})]}),r.jsx(H,{type:"primary",icon:r.jsx(We,{}),size:"small",onClick:()=>u(!0),loading:s,children:"New Script"})]}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx(_t,{style:{flex:1},placeholder:"Select a script",value:e==null?void 0:e.id,onChange:i,loading:s,options:t.map(y=>({label:y.name,value:y.id}))}),e&&r.jsxs(r.Fragment,{children:[r.jsx($e,{title:"Rename Script",children:r.jsx(H,{icon:r.jsx(ss,{}),onClick:d,disabled:s})}),r.jsx($e,{title:"Delete Script",children:r.jsx(H,{danger:!0,icon:r.jsx(rt,{}),onClick:o,disabled:s})})]})]}),e&&r.jsx("div",{children:r.jsxs(J,{type:"secondary",style:{fontSize:12},children:["Last updated: ",new Date(e.updatedAt).toLocaleString()]})})]}),r.jsx(Ce,{title:"Create New Script",open:c,onOk:f,onCancel:()=>{u(!1),w("")},okText:"Create",children:r.jsxs(z,{orientation:"vertical",style:{width:"100%"},children:[r.jsx(J,{children:"Script Name (optional)"}),r.jsx(Te,{placeholder:"e.g., Sales Analysis Q4",value:x,onChange:y=>w(y.target.value),onPressEnter:f,autoFocus:!0}),r.jsx(J,{type:"secondary",style:{fontSize:12},children:"Leave empty for auto-generated name"})]})}),r.jsx(Ce,{title:"Rename Script",open:h,onOk:p,onCancel:()=>{m(!1),S("")},okText:"Rename",children:r.jsxs(z,{orientation:"vertical",style:{width:"100%"},children:[r.jsx(J,{children:"New Script Name"}),r.jsx(Te,{placeholder:"Enter new script name",value:C,onChange:y=>S(y.target.value),onPressEnter:p,autoFocus:!0})]})})]})});pt.displayName="ScriptSelector";const{Text:le}=me,Hs=({selectedFileIds:t,onFileSelect:e,registeredTables:s,onRegisterFiles:i,currentScript:l})=>{const n=Mt(),{files:g,deleteFile:c}=Yt(),[u,h]=a.useState([]),[m,x]=a.useState(!1);a.useEffect(()=>{h(g.filter(o=>o.fileType==="parquet"))},[g]);const w=o=>{t.includes(o)?e(t.filter(d=>d!==o)):e([...t,o])},C=async o=>{try{await c(o),v.success("File deleted"),e(t.filter(d=>d!==o))}catch{v.error("Failed to delete file")}},S=async()=>{const o=u.filter(d=>t.includes(d.id));if(o.length===0){v.warning("Please select at least one file");return}try{x(!0),await i(o),v.success(`Registered ${o.length} ${o.length===1?"table":"tables"}`)}catch{v.error("Failed to register files")}finally{x(!1)}},f=o=>{if(!l)return!1;const d=o.name.replace(/\.parquet$/i,"").replace(/[^a-zA-Z0-9_]/g,"_").toLowerCase(),y=`${l.id}_${d}`;return s.includes(y)},p=o=>l?l.fileIds.includes(o):!1;return r.jsx(Z,{title:r.jsxs(z,{children:[r.jsx(Oe,{}),r.jsx(le,{children:"Parquet Files"}),r.jsx(Ee,{color:"blue",children:u.length})]}),extra:r.jsx(H,{icon:r.jsx(Ft,{}),size:"small",onClick:()=>n("/files"),children:"Manage Files"}),style:{height:"100%",display:"flex",flexDirection:"column"},bodyStyle:{flex:1,overflow:"auto"},children:u.length===0?r.jsxs("div",{style:{textAlign:"center",padding:32},children:[r.jsx(Oe,{style:{fontSize:48,color:"#ccc",marginBottom:16}}),r.jsx(le,{type:"secondary",children:"No Parquet files uploaded"}),r.jsx("br",{}),r.jsx(le,{type:"secondary",style:{fontSize:12},children:"Upload Parquet files from the Files page"})]}):r.jsxs(r.Fragment,{children:[!l&&r.jsx(st,{type:"info",message:"No script selected",description:"Create or select a SQL script to register files",style:{marginBottom:16},showIcon:!0}),r.jsx(z,{style:{marginBottom:16,width:"100%",justifyContent:"space-between"},children:r.jsxs(H,{type:"primary",icon:r.jsx(ze,{}),onClick:S,disabled:t.length===0||!l,loading:m,children:["Register Selected (",t.length,")"]})}),r.jsx(oe,{size:"small",dataSource:u,renderItem:o=>{const d=f(o),y=p(o.id);return r.jsx(oe.Item,{actions:[r.jsx(gt,{title:"Delete file?",description:"This will also delete associated queries and results.",onConfirm:()=>C(o.id),okText:"Delete",okType:"danger",children:r.jsx(H,{size:"small",icon:r.jsx(rt,{}),danger:!0})},"delete")],children:r.jsx(oe.Item.Meta,{avatar:r.jsx(Jt,{checked:t.includes(o.id),onChange:()=>w(o.id)}),title:r.jsxs(z,{children:[r.jsx(le,{children:o.name}),y&&r.jsx(Ee,{color:"blue",style:{fontSize:11},children:"In Script"}),d&&r.jsx($e,{title:"Registered in DuckDB",children:r.jsx(Ne,{style:{color:"#52c41a"}})})]}),description:r.jsxs(z,{size:"small",children:[r.jsx(le,{type:"secondary",style:{fontSize:12},children:Vt(o.size)}),r.jsx(le,{type:"secondary",style:{fontSize:12},children:"â€¢"}),r.jsx(le,{type:"secondary",style:{fontSize:12},children:new Date(o.uploadedAt).toLocaleDateString()})]})})})}})]})})},{Text:Re}=me,ft=a.memo(({query:t,onQueryChange:e,onExecute:s,onSave:i,onReset:l,isExecuting:n,isDirty:g,isSaving:c,canExecute:u})=>{const{theme:h}=et();return r.jsx(Z,{size:"small",title:r.jsxs(z,{children:[r.jsx(Re,{children:"SQL Editor"}),g&&r.jsx(Re,{type:"warning",style:{fontSize:12},children:"(unsaved)"}),c&&r.jsx(Re,{type:"secondary",style:{fontSize:12},children:"(saving...)"})]}),extra:r.jsxs(z,{children:[r.jsx(H,{size:"small",icon:r.jsx(is,{}),onClick:l,children:"Reset"}),r.jsx(H,{size:"small",icon:r.jsx(Zt,{}),onClick:i,disabled:!g,loading:c,children:"Save"}),r.jsx(H,{type:"primary",size:"small",icon:r.jsx(es,{}),onClick:s,disabled:!u||n,loading:n,children:"Run Query"})]}),style:{height:"100%",display:"flex",flexDirection:"column"},styles:{body:{flex:1,display:"flex",flexDirection:"column",padding:1}},children:r.jsx(Kt,{height:"90vh",language:"sql",theme:h==="dark"?"vs-dark":"vs-light",value:t,onChange:m=>e(m||""),options:{minimap:{enabled:!1},fontSize:14,lineNumbers:"on",scrollBeyondLastLine:!1,automaticLayout:!0,tabSize:2,wordWrap:"on",suggest:{showKeywords:!0,showSnippets:!0},quickSuggestions:{other:!0,comments:!1,strings:!1},parameterHints:{enabled:!0},suggestOnTriggerCharacters:!0,acceptSuggestionOnCommitCharacter:!0,acceptSuggestionOnEnter:"on",snippetSuggestions:"top"}})})});ft.displayName="SqlEditor";const{Text:de}=me,_s=({result:t,isLoading:e,id:s})=>{var u;const{theme:i}=et(),{token:l}=Qt.useToken();if(!t&&!e)return r.jsx(Z,{title:"Query Results",style:{height:"100%"},children:r.jsx(he,{description:"No results yet. Execute a query to see results."})});if(e)return r.jsx(Z,{title:"Query Results",style:{height:"100%"},children:r.jsx(he,{description:"Executing query..."})});if((t==null?void 0:t.status)==="error")return r.jsx(Z,{title:r.jsxs(z,{children:[r.jsx(de,{children:"Query Results"}),r.jsx(Ee,{icon:r.jsx(mt,{}),color:"error",children:"Error"})]}),style:{height:"100%"},children:r.jsx(he,{description:r.jsxs("div",{children:[r.jsx(de,{type:"danger",children:"Query execution failed"}),r.jsx("br",{}),r.jsx(de,{type:"secondary",style:{fontSize:12},children:t.errorMessage})]})})});const n=Array.isArray(t==null?void 0:t.result)?t.result:[],g=n.length,c=[{key:"table",label:"Table View",children:n.length>0?r.jsx(ts,{tableData:n,fileId:s,theme:i,token:l}):r.jsx(he,{description:"Query returned no rows"})},{key:"json",label:"JSON View",children:r.jsx("div",{style:{maxHeight:"70vh",overflow:"auto",textAlign:"left"},children:"TBI"})}];return r.jsx(Z,{title:r.jsxs(z,{children:[r.jsx(de,{children:"Query Results"}),r.jsx(Ee,{icon:r.jsx(Ne,{}),color:"success",children:"Success"})]}),extra:r.jsxs(z,{size:"large",children:[r.jsxs(z,{size:"small",children:[r.jsx(ks,{}),r.jsxs(de,{type:"secondary",style:{fontSize:12},children:[(u=t==null?void 0:t.executionTime)==null?void 0:u.toFixed(2),"ms"]})]}),r.jsx(z,{size:"small",children:r.jsxs(de,{type:"secondary",style:{fontSize:12},children:[g," ",g===1?"row":"rows"]})})]}),style:{height:"100%",display:"flex",flexDirection:"column"},styles:{body:{flex:1,overflow:"hidden"}},children:r.jsx(Gt,{defaultActiveKey:"table",items:c,style:{height:"100%"}})})},{Text:Vs,Paragraph:Ge}=me,{Panel:Gs}=nt,Us=({tableNames:t,onInsertTemplate:e})=>{const i=(()=>{if(t.length===0)return[{title:"Getting Started",description:"Select one or more Parquet files from the file list to start querying.",sql:`-- No tables registered yet
-- Upload and register Parquet files to get started`}];const l=t[0],n=[{title:"Preview Table",description:"View the first 100 rows of a table",sql:`SELECT * FROM ${l} LIMIT 100;`},{title:"Count Rows",description:"Count total number of rows",sql:`SELECT COUNT(*) as row_count FROM ${l};`},{title:"Table Schema",description:"View column names and types",sql:`DESCRIBE ${l};`},{title:"Distinct Values",description:"Count unique values in a column",sql:`SELECT column_name, COUNT(DISTINCT column_name) as unique_count
FROM ${l}
GROUP BY column_name;`},{title:"Filter Data",description:"Filter rows using WHERE clause",sql:`SELECT *
FROM ${l}
WHERE column_name = 'value'
LIMIT 100;`},{title:"Aggregate by Group",description:"Group and aggregate data",sql:`SELECT
  category_column,
  COUNT(*) as count,
  AVG(numeric_column) as average
FROM ${l}
GROUP BY category_column
ORDER BY count DESC;`}];return t.length>=2&&n.push({title:"Join Tables",description:"Combine data from multiple tables",sql:`SELECT
  t1.*,
  t2.*
FROM ${t[0]} t1
JOIN ${t[1]} t2 ON t1.id = t2.id
LIMIT 100;`}),n.push({title:"Window Function",description:"Calculate row numbers and rankings",sql:`SELECT
  *,
  ROW_NUMBER() OVER (PARTITION BY category ORDER BY value DESC) as row_num
FROM ${l};`}),n})();return r.jsx(nt,{defaultActiveKey:t.length===0?["1"]:[],style:{marginTop:16},children:r.jsx(Gs,{header:r.jsxs(r.Fragment,{children:[r.jsx(qs,{style:{marginRight:8}}),"Query Templates"]}),children:r.jsx(oe,{size:"small",dataSource:i,renderItem:l=>r.jsx(oe.Item,{actions:[r.jsx(H,{size:"small",icon:r.jsx(rs,{}),onClick:()=>e(l.sql),children:"Insert"})],children:r.jsx(oe.Item.Meta,{title:r.jsx(Vs,{strong:!0,children:l.title}),description:r.jsxs(r.Fragment,{children:[r.jsx(Ge,{style:{margin:0,marginBottom:8},children:l.description}),r.jsx(Ge,{code:!0,copyable:!0,style:{margin:0,whiteSpace:"pre-wrap",fontSize:12},children:l.sql})]})})})})},"1")})},nr=()=>{const[t,e]=a.useState([]),[s,i]=a.useState(new Map),{scripts:l,currentScript:n,loading:g,createScript:c,selectScript:u,renameScript:h,deleteScript:m}=Ls(),{status:x,tables:w,error:C,progressMessage:S,initialize:f,registerFileForScript:p,executeQuery:o,listTables:d}=Ms(),y=t.map(B=>s.get(B)||"").filter(Boolean),{query:b,isDirty:P,isSaving:M,error:j,updateQuery:T,saveQuery:I,resetQuery:ee}=Qs(n,y),{selectedResult:ne,isLoading:ae,error:te,loadResults:se,saveResult:O}=As();a.useEffect(()=>{f()},[f]),a.useEffect(()=>{n&&se(n.id)},[n,se]),a.useEffect(()=>{(async()=>{e(n?n.fileIds:[])})()},[n]),a.useEffect(()=>{C&&v.error(C),j&&v.error(j),te&&v.error(te)},[C,j,te]);const V=a.useCallback(async B=>{if(!n){v.warning("Please create or select a script first");return}const R=new Map(s),N=[...n.registeredTables||[]],E=[...n.fileIds||[]];for(const U of B)try{const X=await p(U);R.set(U.id,X),N.includes(X)||N.push(X),E.includes(U.id)||E.push(U.id),v.success(`Registered ${U.name} for script`)}catch(X){throw v.error(`Failed to register ${U.name}`),X}await K.updateFileIds(n.id,E),await K.updateRegisteredTables(n.id,N),i(R),e(E),await d()},[n,p,s,d]),Q=a.useCallback(async()=>{if(!b.trim()){v.warning("Please enter a SQL query");return}if(!n){v.warning("Please create or select a script first");return}try{const B=await o(b);await O(n.id,b,B.data,B.executionTime,"success"),v.success("Query executed successfully")}catch(B){const R=B instanceof Error?B.message:"Query execution failed";await O(n.id,b,null,0,"error",R),v.error(R)}},[b,n,o,O]),G=a.useCallback(B=>{T(B),v.success("Template inserted")},[T]);return r.jsxs(z,{orientation:"vertical",size:"large",style:{width:"100%",padding:24},children:[r.jsx(Os,{status:x,message:S,tableCount:w.length}),r.jsxs(Ws,{status:x,progressMessage:S,children:[r.jsx(pt,{scripts:l,currentScript:n,loading:g,onSelectScript:u,onCreateScript:c,onRenameScript:h,onDeleteScript:m}),r.jsx(Hs,{selectedFileIds:t,onFileSelect:e,registeredTables:w,onRegisterFiles:V,currentScript:n}),r.jsx(ft,{query:b,onQueryChange:T,onExecute:Q,onSave:I,onReset:ee,isExecuting:x==="executing",isDirty:P,isSaving:M,canExecute:x==="ready"&&n!==null&&t.length>0}),r.jsx(Us,{tableNames:y,onInsertTemplate:G}),r.jsx(_s,{result:ne,isLoading:ae,id:n?n.id:null})]})]})};export{nr as default};
